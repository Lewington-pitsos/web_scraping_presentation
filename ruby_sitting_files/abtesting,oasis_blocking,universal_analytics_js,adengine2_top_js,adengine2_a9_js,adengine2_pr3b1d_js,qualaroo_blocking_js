(function(window){var AbTest,Wikia=window.Wikia=(window.Wikia||{}),config=Wikia.AbTestConfig||{},logCache={},beacon=window.beacon_id||getCookie('wikia_beacon_id'),serverTimeString=window.varnishTime,serverDate=serverTimeString?new Date(serverTimeString):new Date(),serverTime=serverDate.getTime()/1000;var log=(function(console){return(console&&console.log)?function(methodName,message){if(!message){message=methodName;methodName=undefined;}if(!logCache[message]){logCache[message]=!0;console.log('Wikia.AbTest'+(methodName?'.'+methodName+'()':'')+':',message);}}:function(){};})(window.console);AbTest=function(expName){this.expName=expName;};AbTest.uuid=(function(uuid){var ret=uuid&&uuid!='ThisIsFake'?uuid:null;if(!ret){log('init','UUID is not available, A/B testing will be disabled');}return ret;})(beacon);AbTest.isExperimentActive=function(expName){return expName in AbTest.experiments;};AbTest.getGroup=function(expName){var exp=getExperiment(expName,'getGroup'),group=exp&&exp.group;
return group&&group.name;};AbTest.inGroup=function(expName,groupName){return AbTest.getGroup(expName)===groupName;};AbTest.isValidGroup=function(expName,groupName){var exp=getExperiment(expName,'isValidGroup'),current=exp&&exp.current;return!!(current&&current.groups[groupName]);};AbTest.getGASlot=function(expName){var exp=getExperiment(expName,'getGASlot'),current=exp&&exp.current,gaSlot=current&&current.gaSlot;return parseInt(gaSlot,10)||undefined;};AbTest.getExperiments=function(includeAll){var expName,exp,group,el,list=[];if(!AbTest.uuid){list.nouuid=!0;}for(expName in AbTest.experiments){exp=AbTest.experiments[expName];group=exp.group;if(!group&&!includeAll){continue;}el={id:exp.id,name:exp.name,flags:exp.flags};if(group){el.group={id:group.id,name:group.name}}list.push(el);}return list;};AbTest.loadExternalData=function(data){var index,groupData,html='';log('init','Received external configuration');for(index in data){groupData=data[index];if(groupData.styles){html+='<style>'+
groupData.styles+'</style>';}if(groupData.scripts){html+='<script>'+groupData.scripts+'</script>';}}if(html!=''){document.write(html);}};(function(prototype){var i,length,methodNames=['inGroup','getGroup','getGASlot','getUserSlot'];for(i=0,length=methodNames.length;i<length;i++){(function(methodName){prototype[methodName]=function(){return AbTest[methodName].apply(AbTest,[this.expName].concat(arguments));};})(methodNames[i]);}})(AbTest.prototype);function getExperiment(expName,methodName){if(!expName){log(methodName,'Missing required argument "expName".');}var exp=AbTest.experiments[expName];if(!exp){log(methodName,'Experiment configuration not found for "'+expName+'."');}return exp;}function hash(s){var slot=0,i;for(i=0;i<s.length;i++){slot+=s.charCodeAt(i)*(i+1);}return Math.abs(slot)%100;}function getSlot(expName){return AbTest.uuid?hash(AbTest.uuid+expName):-1;}function setActiveGroup(expName,groupName,force){var exp=getExperiment(expName,'setActiveGroup'),current=exp&&exp.current,
group=current&&current.groups[groupName];if(group&&(!exp.group||force)){exp.group=group;return true;}return false;}function isInRanges(value,ranges){var i,range;if(!ranges||!ranges.length){return false;}for(i=0;i<ranges.length;i++){range=ranges[i];if(value>=range.min&&value<=range.max){return true;}}return false;}function getCookie(name){if(!name){return null;}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(name).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;}AbTest.experiments=(function(experiments){var expName,exp,versions,version,i,activeExperiments={},count=0;for(expName in experiments){if(experiments.hasOwnProperty(expName)){exp=experiments[expName];versions=exp.versions;for(i=0;i<versions.length;i++){version=versions[i];if(serverTime>=version.startTime&&serverTime<version.endTime){exp.current=version;exp.flags=version.flags;count++;break;}}if(exp.current){activeExperiments[expName]=exp;}}}AbTest.
experimentCount=count;return activeExperiments;})(config.experiments||{});(function(experiments){var matches,rTreatmentGroups=/AbTest\.([^=]+)=([^?&]+)/gi,queryString=window.location.search,expName,groupName,exp,slot,externalIds=[];if(queryString){while((matches=rTreatmentGroups.exec(queryString))!=null){expName=matches[1];groupName=matches[2];if(!AbTest.isValidGroup(expName,groupName)){log('init','Invalid experiment/group specified in URL: '+expName+'/'+groupName);continue;}setActiveGroup(expName,groupName);}}for(expName in experiments){exp=experiments[expName];slot=getSlot(expName);if(exp.group||!exp.current||slot<0){continue;}if(exp.flags&&exp.flags.limit_to_special_wikis&&!window.wgIsGASpecialWiki){log('init','Skipping experiment '+expName+' - not a special Wiki');continue;}for(groupName in exp.current.groups){if(isInRanges(slot,exp.current.groups[groupName].ranges)){setActiveGroup(expName,groupName);}}}for(expName in experiments){exp=experiments[expName];if(exp.current.external&&
exp.group){externalIds.push(exp.name+'.'+exp.current.id+'.'+exp.group.id);}}if(externalIds.length>0&&!window.Mercury){log('init','Loading external configuration');var url=window.wgCdnApiUrl+'/wikia.php?controller=AbTesting&method=externalData&callback=Wikia.AbTest.loadExternalData&ids=';url+=externalIds.join(',');document.write('<scr'+'ipt src="'+encodeURI(url)+'"></script>');}})(AbTest.experiments);(function(experiments){var expName,exp;for(expName in experiments){exp=experiments[expName];if(Wikia.Tracker&&exp.flags&&exp.flags.dw_tracking&&exp.group){Wikia.Tracker.track({eventName:'ab_treatment',experiment:exp.name,experimentId:exp.id,time:serverTimeString,trackingMethod:'internal',treatmentGroup:exp.group.name,treatmentGroupId:exp.group.id});}}})(AbTest.experiments);Wikia.AbTest=AbTest;})(window);;

(function(context){'use strict';function lazyQueue(){function makeQueue(queue,callback){if(typeof callback!=='function'){throw new Error('LazyQueue used with callback not being a function');}else if(queue instanceof Array){queue.start=function(){while(queue.length>0){callback(queue.shift());}queue.push=function(item){callback(item);};};return queue;}else{throw new Error('LazyQueue requires an array as the first parameter');}}return{makeQueue:makeQueue};}if(!context.Wikia){context.Wikia={};}context.Wikia.LazyQueue=lazyQueue();if(context.define&&context.define.amd){context.define('wikia.lazyqueue',lazyQueue);}}(this));;

(function(window,undefined){'use strict';if(!window.wgNoExternals){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments);},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m);})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');}else{window.ga=function(){};}var cookieExists,isProductionEnv,blockingTracked={babDetector:!1,pageFair:!1},GASettings={babDetector:{trackName:'babDetector',dimension:6,name:'babdetector'},pageFair:{trackName:'pageFair',dimension:7,name:'pagefair'}},listenerSettings=[{eventName:'bab.blocking',value:!0,detectorSettings:GASettings.babDetector},{eventName:'bab.not_blocking',value:!1,detectorSettings:GASettings.babDetector},{eventName:'pf.blocking',value:!0,detectorSettings:GASettings.pageFair},{eventName:'pf.not_blocking',value:!1,detectorSettings:GASettings.pageFair}];isProductionEnv=!window.
wgGaStaging;cookieExists=function(cookieName){return document.cookie.indexOf(cookieName)>-1;};if(isProductionEnv){window.ga('create','UA-32129070-1','auto',{'sampleRate':100,'allowLinker':!0,'userId':window.wgGAUserIdHash});}else{window.ga('create','UA-32129070-2','auto',{'sampleRate':100,'allowLinker':!0,'userId':window.wgGAUserIdHash});}if(isProductionEnv){window.ga('create','UA-32132943-4','auto',{'name':'ve','sampleRate':100,'allowLinker':!0,'userId':window.wgGAUserIdHash});window.ga('ve.require','displayfeatures');}window.ga('require','displayfeatures');function _gaWikiaPush(commands){var i,spec,args=Array.prototype.slice.call(arguments);for(i=0;i<args.length;i++){if(typeof args[i]==='function'){window.ga(args[i]);continue;}else if(args[i][0]==='send'&&args[i].length===7){args[i][6]={'nonInteraction':args[i][6]};}window.ga.apply(window,args[i]);if(args[i][0].indexOf('.')===-1){if(args[i][1]&&args[i][1]==='editor-ve'){spec=args[i].slice();spec[0]='ve.'+spec[0];window.ga.apply
(window,spec);}}}}function getEsrbRating(){var rating='not set';if(window.ads&&window.ads.context.targeting.esrbRating){rating=window.ads.context.targeting.esrbRating;}return rating;}function hasPortableInfobox(){if(window.ads&&window.ads.context.targeting.hasPortableInfobox){return'Yes';}return'No';}function hasFeaturedVideo(){if(window.ads&&window.ads.context.targeting.hasFeaturedVideo){return'Yes';}return'No';}function getKruxSegment(){var kruxSegment='not set',uniqueKruxSegments={ocry7a4xg:'Game Heroes 2014',ocr1te1tc:'Digital DNA 2014',ocr6m2jd6:'Inquisitive Minds 2014',ocr05ve5z:'Culture Caster 2014',ocr88oqh9:'Social Entertainers 2014'},uniqueKruxSegmentsKeys=Object.keys(uniqueKruxSegments),markedSegments=[],kruxSegments=[];if(window.localStorage){kruxSegments=(window.localStorage.kxsegs||'').split(',');}if(kruxSegments.length){markedSegments=uniqueKruxSegmentsKeys.filter(function(n){return kruxSegments.indexOf(n)!==-1;});if(markedSegments.length){kruxSegment=uniqueKruxSegments[
markedSegments[0]];}}return kruxSegment;}function trackBlocking(detectorSettings,isBlocked){var value=isBlocked?'Yes':'No';if(blockingTracked[detectorSettings.trackName]){return;}blockingTracked[detectorSettings.trackName]=!0;_gaWikiaPush(['set','dimension'+detectorSettings.dimension,value]);window.ga('ads.set','dimension'+detectorSettings.dimension,value);guaTrackAdEvent('ad/'+detectorSettings.name+'/detection',value,'',0,true);guaTrackEvent('ads-'+detectorSettings.name+'-detection','impression',value,0,true);}_gaWikiaPush(['set','dimension1',window.wgDBname],['set','dimension2',window.wgContentLanguage],['set','dimension3',window.cscoreCat],['set','dimension4',window.skin],['set','dimension5',!!window.wgUserName?'user':'anon']);_gaWikiaPush(['set','dimension8',window.wikiaPageType],['set','dimension9',window.wgCityId],['set','dimension13',getEsrbRating()],['set','dimension14',window.wgGaHasAds?'Yes':'No'],['set','dimension15',window.wikiaPageIsCorporate?'Yes':'No'],['set',
'dimension16',getKruxSegment()],['set','dimension17',window.wgWikiVertical],['set','dimension18',window.wgWikiCategories.join(',')],['set','dimension19',window.wgArticleType],['set','dimension20','not set'],['set','dimension21',String(window.wgArticleId)],['set','dimension25',String(window.wgNamespaceNumber)],['set','dimension27',String(window.wgCanonicalSpecialPageName||'')],['set','dimension28',hasPortableInfobox()],['set','dimension29',hasFeaturedVideo()]);function isOptimizelyLoadedAndActive(){var optimizely=window.optimizely;return optimizely&&optimizely.activeExperiments&&Array.isArray(optimizely.activeExperiments)&&optimizely.activeExperiments.length>0&&typeof optimizely.allExperiments==='object'&&Object.keys(optimizely.allExperiments).length>0&&typeof optimizely.variationNamesMap==='object'&&Object.keys(optimizely.variationNamesMap).length>0;}if(isOptimizelyLoadedAndActive()){var optimizely=window.optimizely;optimizely.activeExperiments.forEach(function(experimentId){if(
optimizely.allExperiments.hasOwnProperty(experimentId)&&typeof optimizely.allExperiments[experimentId].universal_analytics==='object'){var dimension=optimizely.allExperiments[experimentId].universal_analytics.slot,experimentName=optimizely.allExperiments[experimentId].name,variationName=optimizely.variationNamesMap[experimentId];_gaWikiaPush(['set','dimension'+dimension,'Optimizely '+experimentName+' ('+experimentId+'): '+variationName]);}});}if(window.Wikia&&window.Wikia.AbTest){var abList=window.Wikia.AbTest.getExperiments(true),abExp,abGroupName,abSlot,abIndex,abForceTrackOnLoad=!1,abCustomVarsForAds=[];for(abIndex=0;abIndex<abList.length;abIndex++){abExp=abList[abIndex];if(!abExp||!abExp.flags){continue;}if(!abExp.flags.ga_tracking){continue;}if(abExp.flags.forced_ga_tracking_on_load&&abExp.group){abForceTrackOnLoad=!0;}abSlot=window.Wikia.AbTest.getGASlot(abExp.name);if(abSlot>=40&&abSlot<=49){abGroupName=abExp.group?abExp.group.name:(abList.nouuid?'NOBEACON':
'NOT_IN_ANY_GROUP');_gaWikiaPush(['set','dimension'+abSlot,abGroupName]);abCustomVarsForAds.push(['ads.set','dimension'+abSlot,abGroupName]);}}if(abForceTrackOnLoad){var abRenderStart=window.wgNow||(new Date()),abOnLoadHandler;abOnLoadHandler=function(){var renderTime=(new Date()).getTime()-abRenderStart.getTime();setTimeout(function(){window.guaTrackEvent('ABtest','ONLOAD','TIME',renderTime);},10);};if(window.attachEvent){window.attachEvent('onload',abOnLoadHandler);}else if(window.addEventListener){window.addEventListener('load',abOnLoadHandler,false);}}}_gaWikiaPush(['send','pageview']);if(window.ads&&window.ads.context.opts.showAds){listenerSettings.map(function(listenerSetting){document.addEventListener(listenerSetting.eventName,function(){trackBlocking(listenerSetting.detectorSettings,listenerSetting.value);});});}if(isProductionEnv){window.ga('create','UA-32129071-1','auto',{'name':'ads','sampleRate':100,'allowLinker':!0,'userId':window.wgGAUserIdHash});}else{window.ga(
'create','UA-32129071-2','auto',{'name':'ads','sampleRate':100,'allowLinker':!0,'userId':window.wgGAUserIdHash});}window.ga('ads.require','displayfeatures');window.ga('ads.set','dimension1',window.wgDBname);window.ga('ads.set','dimension2',window.wgContentLanguage);window.ga('ads.set','dimension3',window.cscoreCat);window.ga('ads.set','dimension4',window.skin);window.ga('ads.set','dimension5',!!window.wgUserName?'user':'anon');window.ga('ads.set','dimension8',window.wikiaPageType);window.ga('ads.set','dimension9',window.wgCityId);window.ga('ads.set','dimension13',getEsrbRating());window.ga('ads.set','dimension14',window.wgGaHasAds?'Yes':'No');window.ga('ads.set','dimension15',window.wikiaPageIsCorporate?'Yes':'No');window.ga('ads.set','dimension16',getKruxSegment());window.ga('ads.set','dimension17',window.wgWikiVertical);window.ga('ads.set','dimension18',window.wgWikiCategories.join(','));window.ga('ads.set','dimension19',window.wgArticleType);window.ga('ads.set','dimension20',
'not set');window.ga('ads.set','dimension21',String(window.wgArticleId));window.ga('ads.set','dimension25',String(window.wgNamespaceNumber));window.ga('ads.set','dimension27',String(window.wgCanonicalSpecialPageName||''));window.ga('ads.set','dimension28',hasPortableInfobox());window.ga('ads.set','dimension29',hasFeaturedVideo());if(window.Wikia&&window.Wikia.AbTest){var i;for(i=0;i<abCustomVarsForAds.length;i++){window.ga.apply(window,abCustomVarsForAds[i]);}}window.guaTrackAdEvent=function(category,action,opt_label,opt_value,opt_noninteractive){var args,adHitSample=1;if(Math.random()*100<=adHitSample){args=Array.prototype.slice.call(arguments);if(args.length===5){args[4]={'nonInteraction':args[4]};}args.unshift('ads.send','event');try{window.ga.apply(window,args);}catch(e){}}};window.guaTrackEvent=function(category,action,opt_label,opt_value,opt_noninteractive){var args=Array.prototype.slice.call(arguments);args.unshift('send','event');try{_gaWikiaPush(args);}catch(e){}};window.
guaTrackPageview=function(fakePage,opt_namespace){var nsPrefix=(opt_namespace)?opt_namespace+'.':'';_gaWikiaPush([nsPrefix+'send','pageview',fakePage]);};window.guaSetCustomDimension=function(index,value){_gaWikiaPush(['set','dimension'+index,value]);}}(window));;

define('ext.wikia.adEngine.adLogicPageParams',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.utils.adLogicZoneParams','wikia.document','wikia.geo','wikia.location','wikia.log','wikia.window',require.optional('wikia.abTest'),require.optional('wikia.krux')],function(adContext,zoneParams,doc,geo,loc,log,win,abTest,krux){'use strict';var context={},logGroup='ext.wikia.adEngine.adLogicPageParams',runtimeParams={};function updateContext(){context=adContext.getContext();}function getAb(){var experiments,experimentsNumber,i,ab=[];if(abTest){experiments=abTest.getExperiments();experimentsNumber=experiments.length;for(i=0;i<experimentsNumber;i+=1){ab.push(experiments[i].id+'_'+experiments[i].group.id);}}return ab;}function extend(target,obj){var key;for(key in obj){if(obj.hasOwnProperty(key)){target[key]=obj[key];}}return target;}function addParam(key,value){runtimeParams[key]=value;}function decodeLegacyDartParams(dartString){var params={},kvs,kv,key,value,i,len;log([
'decodeLegacyDartParams',dartString],9,logGroup);if(typeof dartString==='string'){kvs=dartString.split(';');for(i=0,len=kvs.length;i<len;i+=1){kv=kvs[i].split('=');key=kv[0];value=kv[1];if(key&&value&&key!=='esrb'){params[key]=params[key]||[];params[key].push(value);}}}return params;}function getRefParam(){var hostnameMatch,ref=doc.referrer,refHostname,searchDomains=/(google|search\.yahooo|bing|baidu|ask|yandex)/,wikiDomains=['wikia.com','ffxiclopedia.org','jedipedia.de','memory-alpha.org','uncyclopedia.org','websitewiki.de','wowwiki.com','yoyowiki.org'],wikiDomainsRegex=new RegExp('(^|\\.)('+wikiDomains.join('|').replace(/\./g,'\\.')+')$');if(!ref||typeof ref!=='string'){return'direct';}refHostname=ref.match(/\/\/([^\/]+)\//);if(refHostname){refHostname=refHostname[1];}hostnameMatch=refHostname===loc.hostname;if(hostnameMatch&&(ref.indexOf('search=')>-1||ref.indexOf('query=')>-1)){return'wiki_search';}if(hostnameMatch){return'wiki';}hostnameMatch=wikiDomainsRegex.test(refHostname);if(
hostnameMatch&&(ref.indexOf('search=')>-1||ref.indexOf('query=')>-1||ref.indexOf('s=')>-1)){return'wikia_search';}if(hostnameMatch){return'wikia';}if(searchDomains.test(refHostname)){return'external_search';}return'external';}function getAspectRatio(){return win.innerWidth>win.innerHeight?'4:3':'3:4';}function getPageLevelParams(options){log('getPageLevelParams',9,logGroup);var params,targeting=context.targeting;options=options||{};params={s0:zoneParams.getSite(),s0v:zoneParams.getVertical(),s0c:zoneParams.getWikiCategories(),s1:zoneParams.getName(),s2:zoneParams.getPageType(),ab:getAb(),ar:getAspectRatio(),artid:targeting.pageArticleId&&targeting.pageArticleId.toString(),cat:zoneParams.getPageCategories(),dmn:zoneParams.getDomain(),hostpre:zoneParams.getHostnamePrefix(),skin:targeting.skin,lang:zoneParams.getLanguage(),wpage:targeting.pageName&&targeting.pageName.toLowerCase(),ref:getRefParam(),esrb:targeting.esrbRating,geo:geo.getCountryCode()||'none'};if(win.pvNumber){params.pv=win.
pvNumber.toString();}if(options.includeRawDbName){params.rawDbName=zoneParams.getRawDbName();}if(krux&&targeting.enableKruxTargeting){params.u=krux.getUser();params.ksgmnt=krux.getSegments();}if(targeting.wikiIsTop1000){params.top='1k';}extend(params,decodeLegacyDartParams(targeting.wikiCustomKeyValues));extend(params,runtimeParams);log(params,9,logGroup);return params;}updateContext();adContext.addCallback(updateContext);return{add:addParam,getPageLevelParams:getPageLevelParams};});;define('ext.wikia.adEngine.adLogicPageViewCounter',['wikia.cache','wikia.window'],function(cache,window){'use strict';var cacheKey='adEngine_pageViewCounter',cacheTtl=24*3600*1000,now=window.wgNow||new Date(),initialValue={since:now.getTime(),pvs:0};function isValidValue(val){if(!val||isNaN(val.since)||isNaN(val.pvs)){return false;}var pvs=val.pvs,age=now.getTime()-val.since;if(pvs<0||age<0||age>cacheTtl){return false;}return true;}function get(){var val=cache.get(cacheKey,now);if(!isValidValue(val)){val=
initialValue;}return val.pvs;}function increment(){var val,age,ttlLeft;val=cache.get(cacheKey,now);if(!isValidValue(val)){val=initialValue;}age=now.getTime()-val.since;ttlLeft=cacheTtl-age;val.pvs+=1;cache.set(cacheKey,val,ttlLeft,now);}return{get:get,increment:increment};});;define('ext.wikia.adEngine.adTracker',['ext.wikia.adEngine.utils.timeBuckets','wikia.tracker','wikia.window','wikia.log'],function(timeBuckets,tracker,win,log){'use strict';var buckets=[0.0,0.5,1.0,1.5,2.0,2.5,3.5,5.0,8.0,20.0,60.0],logGroup='ext.wikia.adEngine.adTracker';function encodeAsQueryString(extraParams){var out=[],key,keys=[],i,len;if(win.ads&&win.ads.runtime.pf&&typeof win.ads.runtime.pf.blocking==='boolean'){extraParams.pf=win.ads.runtime.pf.blocking?'yes':'no';}if(win.ads&&win.ads.runtime.bab&&typeof win.ads.runtime.bab.blocking==='boolean'){extraParams.bab=win.ads.runtime.bab.blocking?'yes':'no';}for(key in extraParams){if(extraParams.hasOwnProperty(key)){keys.push(key);}}keys.sort();for(i=0,len=keys
.length;i<len;i+=1){key=keys[i];out.push(key+'='+extraParams[key]);}return out.join(';');}function track(eventName,data,value,forcedLabel){var category='ad/'+eventName,action=typeof data==='string'?data:encodeAsQueryString(data||{}),gaLabel=forcedLabel,gaValue,trackValue;if(!gaLabel){if(value===undefined){gaLabel='';value=0;}else{gaLabel=timeBuckets.getTimeBucket(buckets,value/1000);if(/\+$|invalid/.test(gaLabel)){category=category.replace('ad','ad/error');}}}gaValue=Math.round(value);action=action||'nodata';trackValue={ga_category:category,ga_action:action,ga_label:gaLabel,ga_value:isNaN(gaValue)?0:gaValue,trackingMethod:'ad'};tracker.track(trackValue);log(trackValue,'debug',logGroup);}function trackDW(data,eventName){var trackValue={eventName:eventName,trackingMethod:'internal'};if(typeof data==='string'){trackValue.ping=data;}else{Object.keys(data).forEach(function(key){trackValue[key]=data[key];});}tracker.track(trackValue);log(['trackDW',trackValue],'debug',logGroup);}function
measureTime(eventName,eventData,eventType){var timingValue=win.wgNow&&new Date().getTime()-win.wgNow.getTime();eventType=eventType?'/'+eventType:'';return{measureDiff:function(diffData,diffType){eventType='/'+diffType;eventData=diffData;timingValue=win.wgNow&&new Date().getTime()-win.wgNow.getTime()-timingValue;return{track:this.track};},track:function(){if(timingValue){track('timing/'+eventName+eventType,eventData,timingValue);}}};}return{track:track,trackDW:trackDW,measureTime:measureTime};});;define('ext.wikia.adEngine.utils.eventDispatcher',['wikia.document','wikia.log','wikia.window'],function(doc,log,win){'use strict';var logGroup='ext.wikia.adEngine.utils.eventDispatcher';function dispatchEvent(name,data){var event=doc.createEvent('CustomEvent');event.initCustomEvent(name,true,true,data||{});win.dispatchEvent(event);log(['dispatchEvent',name,data],'info',logGroup);}return{dispatch:dispatchEvent};});;define('ext.wikia.adEngine.utils.sampler',['wikia.querystring'],function(
QueryString){'use strict';var qs=new QueryString(),queryStringParam='ignored_samplers';function samplerIsIgnored(name){var ignored=qs.getVal(queryStringParam,'').split(',');return ignored.indexOf(name)>-1;}function sample(name,partToSample,all){return samplerIsIgnored(name)?true:getRandomInt(0,all)<partToSample;}function getRandomInt(min,max){return Math.floor(Math.random()*(max-min))+min;}return{sample:sample};});;define('ext.wikia.adEngine.utils.timeBuckets',function(){function getTimeBucket(timeBuckets,time){var i,len=timeBuckets.length,bucket;for(i=0;i<len;i+=1){if(time>=timeBuckets[i]){bucket=i;}}if(bucket===len-1){return timeBuckets[bucket]+'+';}if(bucket>=0){return timeBuckets[bucket]+'-'+timeBuckets[bucket+1];}return'invalid';}return{getTimeBucket:getTimeBucket}});;define('ext.wikia.adEngine.adContext',['wikia.browserDetect','wikia.cookies','wikia.document','wikia.geo','wikia.instantGlobals','ext.wikia.adEngine.utils.sampler','wikia.window','wikia.querystring'],function(
browserDetect,cookies,doc,geo,instantGlobals,sampler,w,Querystring){'use strict';instantGlobals=instantGlobals||{};var context,callbacks=[],qs=new Querystring();function getContext(){return context;}function getMercuryCategories(){if(!context.targeting.mercuryPageCategories){return;}return context.targeting.mercuryPageCategories.map(function(item){return item.title;});}function isUrlParamSet(param){return!!parseInt(qs.getVal(param,'0'),10);}function isPageType(pageType){return context.targeting.pageType===pageType;}function isInstartLogicSupportedBrowser(){return browserDetect.isChrome()&&browserDetect.getBrowserVersion()>45;}function isPageFairDetectionEnabled(){var isSupportedGeo=geo.isProperGeo(instantGlobals.wgAdDriverPageFairDetectionCountries);return isUrlParamSet('pagefairdetection')||(isSupportedGeo&&sampler.sample('pageFairDetection',1,10));}function isBabDetectionDesktopEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverBabDetectionDesktopCountries);}function
isBabDetectionMobileEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverBabDetectionMobileCountries);}function updateDetectionServicesAdContext(context,noExternals){context.opts.pageFairDetection=!noExternals&&isPageFairDetectionEnabled();context.opts.babDetectionDesktop=!noExternals&&isBabDetectionDesktopEnabled();context.opts.babDetectionMobile=!noExternals&&isBabDetectionMobileEnabled();}function updateAdContextRecoveryServices(context,noExternals){var isRecoveryServiceAlreadyEnabled=!1,serviceCanBeEnabled=!noExternals&&context.opts.showAds!==!1;context.opts.instartLogicRecovery=serviceCanBeEnabled&&!isRecoveryServiceAlreadyEnabled&&context.opts.instartLogicRecovery&&geo.isProperGeo(instantGlobals.wgAdDriverInstartLogicRecoveryCountries)&&isInstartLogicSupportedBrowser();isRecoveryServiceAlreadyEnabled|=context.opts.instartLogicRecovery;context.opts.pageFairRecovery=serviceCanBeEnabled&&!isRecoveryServiceAlreadyEnabled&&context.opts.pageFairRecovery&&geo.isProperGeo(
instantGlobals.wgAdDriverPageFairRecoveryCountries)&&!browserDetect.isEdge();context.opts.babRecovery=serviceCanBeEnabled&&geo.isProperGeo(instantGlobals.wgAdDriverBabRecoveryCountries);}function updateAdContextBidders(context){var hasFeaturedVideo=context.targeting.hasFeaturedVideo;context.bidders.rubiconDisplay=geo.isProperGeo(instantGlobals.wgAdDriverRubiconDisplayPrebidCountries);context.bidders.rubicon=geo.isProperGeo(instantGlobals.wgAdDriverRubiconPrebidCountries)&&!hasFeaturedVideo;context.bidders.beachfront=geo.isProperGeo(instantGlobals.wgAdDriverBeachfrontBidderCountries)&&!hasFeaturedVideo;context.bidders.appnexusAst=geo.isProperGeo(instantGlobals.wgAdDriverAppNexusAstBidderCountries)&&!hasFeaturedVideo;context.bidders.a9Video=geo.isProperGeo(instantGlobals.wgAdDriverA9VideoBidderCountries);}function referrerIsSonySite(){return doc&&doc.referrer&&doc.referrer.match(/info\.tvsideview\.sony\.net/);}function isMOATTrackingForFVEnabled(){var samplingForMoatFV=instantGlobals.
wgAdDriverMoatTrackingForFeaturedVideoAdSampling||1;return sampler.sample('moatTrackingForFeaturedVideo',samplingForMoatFV,100)&&geo.isProperGeo(instantGlobals.wgAdDriverMoatTrackingForFeaturedVideoAdCountries);}function setContext(newContext){var i,len,fvAdsFrequency=instantGlobals.wgAdDriverPlayAdsOnNextFVFrequency,noExternals=w.wgNoExternals||isUrlParamSet('noexternals');context=newContext;context.opts=context.opts||{};context.slots=context.slots||{};context.targeting=context.targeting||{};context.providers=context.providers||{};context.bidders=context.bidders||{};context.forcedProvider=qs.getVal('forcead',null)||context.forcedProvider||null;context.opts.noExternals=noExternals;if(referrerIsSonySite()){context.opts.showAds=!1;}if(geo.isProperGeo(instantGlobals.wgAdDriverDelayCountries)){context.opts.delayEngine=!0;}context.opts.premiumOnly=context.targeting.hasFeaturedVideo&&geo.isProperGeo(instantGlobals.wgAdDriverSrcPremiumCountries);context.opts.
isMoatTrackingForFeaturedVideoEnabled=isMOATTrackingForFVEnabled();updateDetectionServicesAdContext(context,noExternals);updateAdContextRecoveryServices(context,noExternals);updateAdContextBidders(context);if(cookies.get('mock-ads')==='NlfdjR5xC0'){context.opts.showcase=!0;}if(context.targeting.enablePageCategories){context.targeting.pageCategories=w.wgCategories||getMercuryCategories();}if(context.providers.evolve2){context.providers.evolve2=geo.isProperGeo(instantGlobals.wgAdDriverEvolve2Countries);}if(geo.isProperGeo(instantGlobals.wgAdDriverTurtleCountries)){context.providers.turtle=!0;}context.opts.enableRemnantNewAdUnit=geo.isProperGeo(instantGlobals.wgAdDriverMEGACountries);context.slots.invisibleHighImpact=(context.slots.invisibleHighImpact&&geo.isProperGeo(instantGlobals.wgAdDriverHighImpactSlotCountries))||isUrlParamSet('highimpactslot');context.opts.kikimoraViewabilityTracking=geo.isProperGeo(instantGlobals.wgAdDriverKikimoraViewabilityTrackingCountries);context.opts.
enableAdInfoLog=geo.isProperGeo(instantGlobals.wgAdDriverKikimoraTrackingCountries);context.opts.playerTracking=geo.isProperGeo(instantGlobals.wgAdDriverKikimoraPlayerTrackingCountries);context.targeting.enableKruxTargeting=!!(context.targeting.enableKruxTargeting&&geo.isProperGeo(instantGlobals.wgAdDriverKruxCountries)&&!instantGlobals.wgSitewideDisableKrux);context.opts.floatingMedrec=!!(context.opts.showAds&&context.opts.adsInContent&&(isPageType('article')||isPageType('search'))&&!context.targeting.wikiIsCorporate);context.opts.outstreamVideoFrequencyCapping=instantGlobals.wgAdDriverOutstreamVideoFrequencyCapping;context.opts.porvataMoatTrackingEnabled=geo.isProperGeo(instantGlobals.wgAdDriverPorvataMoatTrackingCountries);context.opts.porvataMoatTrackingSampling=instantGlobals.wgAdDriverPorvataMoatTrackingSampling||0;context.opts.megaAdUnitBuilderEnabled=context.targeting.hasFeaturedVideo&&geo.isProperGeo(instantGlobals.wgAdDriverMegaAdUnitBuilderForFVCountries);context.opts.
isFVMidrollEnabled=geo.isProperGeo(instantGlobals.wgAdDriverFVMidrollCountries);context.opts.isFVPostrollEnabled=geo.isProperGeo(instantGlobals.wgAdDriverFVPostrollCountries);context.opts.replayAdsForFV=geo.isProperGeo(instantGlobals.wgAdDriverPlayAdsOnNextFVCountries);context.opts.fvAdsFrequency=fvAdsFrequency!==undefined?fvAdsFrequency:3;context.opts.disableSra=geo.isProperGeo(instantGlobals.wgAdDriverDisableSraCountries);context.opts.isBLBOnMobileEnabled=geo.isProperGeo(instantGlobals.wgAdDriverBottomLeaderBoardOnMobileCountries);if(w.ads&&w.ads.context){w.ads.context=context;}for(i=0,len=callbacks.length;i<len;i+=1){callbacks[i](context);}}function addCallback(callback){callbacks.push(callback);}function get(path){var isPathValid=path!==undefined&&path!=='',nextElement=getContext(),nodes=(path||'').split('.');while(isPathValid&&nodes.length>0&&typeof nextElement==='object'){nextElement=nextElement[nodes.shift()];}return nextElement;}setContext((w.ads&&w.ads.context)?w.ads.context:{
});return{get:get,addCallback:addCallback,getContext:getContext,setContext:setContext};});;define('ext.wikia.adEngine.context.slotsContext',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.video.videoFrequencyMonitor','wikia.document','wikia.geo','wikia.instantGlobals','wikia.log'],function(adContext,videoFrequencyMonitor,doc,geo,instantGlobals,log){'use strict';var logGroup='ext.wikia.adEngine.context.slotsContext',slots={};function setStatus(slotName,status){log(['setStatus',slotName,status],log.levels.info,logGroup);slots[slotName]=!!status;}function isInContentApplicable(){var header=doc.querySelectorAll('#mw-content-text > h2')[1];return header&&header.offsetWidth>=header.parentNode.offsetWidth;}function setupSlots(){var context=adContext.getContext(),isHome=context.targeting.pageType==='home',isOasis=context.targeting.skin==='oasis',isIncontentEnabled=!isHome&&isOasis&&!context.targeting.hasFeaturedVideo&&isInContentApplicable()&&videoFrequencyMonitor.videoCanBeLaunched();
setStatus('TOP_LEADERBOARD',true);setStatus('TOP_RIGHT_BOXAD',true);setStatus('BOTTOM_LEADERBOARD',context.targeting.skin==='oasis');setStatus('INCONTENT_BOXAD_1',!isHome);setStatus('INVISIBLE_HIGH_IMPACT_2',!context.targeting.hasFeaturedVideo&&geo.isProperGeo(instantGlobals.wgAdDriverHighImpact2SlotCountries));setStatus('INCONTENT_PLAYER',isIncontentEnabled);setStatus('FEATURED',context.targeting.hasFeaturedVideo);log(['Slots:',slots],log.levels.info,logGroup);}function isApplicable(slotName){return slots[slotName]!==!1;}function filterSlotMap(slotMap){var map={};if(!slotMap){return map;}Object.keys(slotMap).forEach(function(slotName){if(isApplicable(slotName)){map[slotName]=slotMap[slotName];}});return map;}setupSlots();return{filterSlotMap:filterSlotMap,isApplicable:isApplicable,setStatus:setStatus};});;define('ext.wikia.adEngine.lookup.lookupFactory',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adTracker','ext.wikia.aRecoveryEngine.adBlockDetection','wikia.lazyqueue',
'wikia.log',require.optional('ext.wikia.adEngine.mobile.mercuryListener'),require.optional('wikia.promise')],function(adContext,adTracker,adBlockDetection,lazyQueue,log,mercuryListener,Promise){'use strict';function create(module){var called,onResponseCallbacks,response,timing,context=adContext.getContext();function onResponse(){log('onResponse','debug',module.logGroup);timing.measureDiff({},'end').track();module.calculatePrices();response=!0;onResponseCallbacks.start();if(module.name==='prebid'){module.trackAdaptersOnLookupEnd();}else{adTracker.track(module.name+'/lookup_end',module.getPrices(),0,'nodata');}}function addResponseListener(callback){onResponseCallbacks.push(callback);}function call(){log('call','debug',module.logGroup);response=!1;if(!Object.keys){log(['call','Module is not supported in IE8',module.name],'debug',module.logGroup);return;}timing=adTracker.measureTime(module.name,{},'start');timing.track();module.call(context.targeting.skin||'mercury',onResponse);
called=!0;adBlockDetection.addOnBlockingCallback(onResponseCallbacks.start);}function wasCalled(){log(['wasCalled',called],'debug',module.logGroup);return called;}function trackState(providerName,slotName,params){log(['trackState',response,providerName,slotName],'debug',module.logGroup);var category,encodedParams,eventName;if(!module.isSlotSupported(slotName)){log(['trackState','Not supported slot',slotName],'debug',module.logGroup);return;}if(module.name==='prebid'){module.trackAdaptersSlotState(providerName,slotName,params);}else{encodedParams=module.encodeParamsForTracking(params,slotName);eventName=encodedParams?'lookup_success':'lookup_error';category=module.name+'/'+eventName+'/'+providerName;adTracker.track(category,slotName,0,encodedParams||'nodata');}}function getSlotParams(slotName,floorPrice){log(['getSlotParams',slotName,called,response],'debug',module.logGroup);if(!called||!module.isSlotSupported(slotName)){log(['getSlotParams','Not called or slot is not supported',
slotName],'debug',module.logGroup);return{};}return module.getSlotParams(slotName,floorPrice);}function getBestSlotPrice(slotName){if(module.getBestSlotPrice){return module.getBestSlotPrice(slotName);}return{};}function getName(){return module.name;}function hasResponse(){log(['hasResponse',response],'debug',module.logGroup);return response;}function isSlotSupported(slotName){return module.isSlotSupported(slotName);}function resetState(){called=!1;onResponseCallbacks=[];response=!1;lazyQueue.makeQueue(onResponseCallbacks,function(callback){callback();});}function waitForResponse(milisToTimeout){return Promise.createWithTimeout(function(resolve){if(hasResponse()){resolve();}else{addResponseListener(resolve);}},milisToTimeout);}function waitForResponseCallbacks(onSuccess,onTimeout,millisToTimeout){var resolved=!1,timeoutId;if(hasResponse()){onSuccess();}else{timeoutId=setTimeout(function(){onTimeout();resolved=!0;},millisToTimeout);addResponseListener(function(){if(!resolved){
onSuccess();if(timeoutId){clearTimeout(timeoutId);}}});}}resetState();if(mercuryListener){mercuryListener.onEveryPageChange(resetState);}return{addResponseListener:addResponseListener,call:call,getBestSlotPrice:getBestSlotPrice,getName:getName,getSlotParams:getSlotParams,hasResponse:hasResponse,isSlotSupported:isSlotSupported,trackState:trackState,wasCalled:wasCalled,waitForResponse:waitForResponse,waitForResponseCallbacks:waitForResponseCallbacks};}return{create:create};});;define('ext.wikia.adEngine.slot.adSlot',['ext.wikia.adEngine.slot.adUnitBuilder','ext.wikia.adEngine.slot.service.megaAdUnitBuilder','wikia.document','wikia.log'],function(adUnitBuilder,megaAdUnitBuilder,doc,log){'use strict';var logGroup='ext.wikia.adEngine.slot.adSlot';function create(name,container,callbacks){function registerHook(name){return function(adInfo){if(typeof callbacks[name]==='function'){return callbacks[name](adInfo);}};}return{name:name,container:container,isViewed:!1,enabled:!0,isEnabled:
registerHook('isEnabled'),disable:registerHook('disable'),enable:registerHook('enable'),collapse:registerHook('collapse'),hop:registerHook('hop'),renderEnded:registerHook('renderEnded'),success:registerHook('success'),viewed:registerHook('viewed')};}function getShortSlotName(slotName){if(megaAdUnitBuilder.isValid(slotName)){return megaAdUnitBuilder.getShortSlotName(slotName);}return adUnitBuilder.getShortSlotName(slotName);}function getIframe(slotName){var cssSelector='#'+slotName+' > .provider-container:not(.hidden) div[id*="_container_"] > iframe',iframe=doc.querySelector(cssSelector);log(['getIframe',slotName,iframe&&iframe.id],log.levels.debug,logGroup);return iframe;}function getProviderContainer(slotName){var slotContainer=doc.getElementById(slotName);if(slotContainer){return slotContainer.lastElementChild||null;}return null;}return{create:create,getIframe:getIframe,getProviderContainer:getProviderContainer,getShortSlotName:getShortSlotName};});;define(
'ext.wikia.adEngine.slot.adUnitBuilder',['ext.wikia.adEngine.adLogicPageParams'],function(page){'use strict';var dfpId='5441';function build(slotName,src){var params=page.getPageLevelParams();if(slotName instanceof Array){slotName=slotName[0];}return['',dfpId,'wka.'+params.s0,params.s1,'',params.s2,src,slotName].join('/');}function getShortSlotName(adUnit){return adUnit.replace(/^.*\/([^\/]*)$/,'$1');}return{build:build,getShortSlotName:getShortSlotName};});;define('ext.wikia.adEngine.slot.service.kiloAdUnitBuilder',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adLogicPageParams'],function(adContext,page){'use strict';var dfpId='5441',context;function getContextTargeting(){if(!context){context=adContext.getContext();}return context.targeting;}function build(slotName,src){var params=page.getPageLevelParams();if(slotName instanceof Array){slotName=slotName[0];}var wikiName=getContextTargeting().wikiIsTop1000?params.s1:'_not_a_top1k_wiki';return['',dfpId,'wka.'+params.s0,wikiName,''
,params.s2,src,slotName].join('/');}function getShortSlotName(adUnit){return adUnit.replace(/^.*\/([^\/]*)$/,'$1');}return{build:build,getShortSlotName:getShortSlotName};});;define('ext.wikia.adEngine.slot.service.megaAdUnitBuilder',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adLogicPageParams','ext.wikia.adEngine.context.slotsContext','wikia.browserDetect'],function(adContext,page,slotsContext,browserDetect){'use strict';var dfpId='5441',megaSlots=['INVISIBLE_SKIN'],context;function getContextTargeting(){if(!context){context=adContext.getContext();}return context.targeting;}function findSlotGroup(map,slotName){var result=Object.keys(map).filter(function(name){return map[name].indexOf(slotName)!==-1;});return result.length===1?result[0]:null;}function getGroup(slotName){var map={'LB':['TOP_LEADERBOARD','MOBILE_TOP_LEADERBOARD'],'MR':['TOP_RIGHT_BOXAD'],'PF':['MOBILE_PREFOOTER','BOTTOM_LEADERBOARD','MOBILE_BOTTOM_LEADERBOARD'],'PX':['INVISIBLE_SKIN','INVISIBLE_HIGH_IMPACT',
'INVISIBLE_HIGH_IMPACT_2'],'HiVi':['INCONTENT_BOXAD_1','MOBILE_IN_CONTENT'],'VIDEO':['FEATURED','OUTSTREAM','UAP_BFAA','UAP_BFAB','ABCD','VIDEO']};return findSlotGroup(map,slotName.toUpperCase())||'OTHER';}function getDevice(params){var result='unknown';if(params.s2==='special'){return'unknown-specialpage';}if(params.skin==='oasis'){result=browserDetect.isMobile()?'tablet':'desktop';}else if(params.skin==='mercury'||params.skin==='mobile-wiki'){result='smartphone';}return result;}function build(slotName,src,slotNameSuffix){var adUnitElements,params=page.getPageLevelParams(),device=getDevice(params),provider=src.indexOf('remnant')===-1?'wka1a':'wka2a',wikiName=getContextTargeting().wikiIsTop1000?params.s1:'_not_a_top1k_wiki',vertical=params.s0;adUnitElements=['',dfpId,provider+'.'+getGroup(slotName),slotName.toLowerCase()+(slotNameSuffix||''),device,params.skin+'-'+getAdLayout(params),wikiName+'-'+vertical];return adUnitElements.join('/');}function getAdLayout(params){var layout=params.
s2,incontentSlotName=params.skin==='oasis'?'INCONTENT_PLAYER':'MOBILE_IN_CONTENT';if(slotsContext.isApplicable(incontentSlotName)){layout=layout+'-ic';}return layout;}function isValid(adUnit){return adUnit.indexOf('wka1a.')!==-1||adUnit.indexOf('wka2a.')!==-1;}function getShortSlotName(adUnit){return adUnit.replace(/^.*\/(wka1a|wka2a)\.[\w]+\/([^\/]*)\/.*$/,function(){if(arguments[2]){return arguments[2].toUpperCase();}});}function isMegaSlot(slotName){return megaSlots.indexOf(slotName)!==-1||(getContextTargeting().skin==='mercury'&&slotName==='BOTTOM_LEADERBOARD');}adContext.addCallback(function(){context=null;});return{build:build,getShortSlotName:getShortSlotName,isValid:isValid,isMegaSlot:isMegaSlot};});;define('ext.wikia.adEngine.slot.service.slotRegistry',['ext.wikia.adEngine.adContext','wikia.window'],function(adContext,win){'use strict';var slots={},slotQueueCount={},scrollYOnDfpRequest={};function incrementSlotQueueCount(slotName){slotQueueCount[slotName]=slotQueueCount[
slotName]||0;if(slots[slotName].length===0){slotQueueCount[slotName]+=1;}}function add(slot,providerName){slots[slot.name]=slots[slot.name]||[];incrementSlotQueueCount(slot.name);slots[slot.name].push({providerName:providerName,slot:slot});}function get(slotName,providerName){var slotsCount,foundSlots;if(!slots[slotName]){return null;}slotsCount=slots[slotName].length;if(!slotsCount){return null;}if(!providerName){return slots[slotName][slotsCount-1].slot;}foundSlots=slots[slotName].filter(function(registryRow){if(registryRow.providerName===providerName){return registryRow.slot;}});if(foundSlots.length){return foundSlots[0].slot;}return null;}function getRefreshCount(slotName){return slotQueueCount[slotName]||0;}function reset(slotName){slots[slotName]=[];}adContext.addCallback(function(){slots={};slotQueueCount={};});function storeScrollY(slotName){scrollYOnDfpRequest[slotName]=win.scrollY||win.pageYOffset;}function getScrollY(slotName){return scrollYOnDfpRequest[slotName];}return{add
:add,get:get,getRefreshCount:getRefreshCount,getScrollY:getScrollY,reset:reset,storeScrollY:storeScrollY};});;define('ext.wikia.adEngine.slot.service.srcProvider',['ext.wikia.adEngine.adContext','ext.wikia.aRecoveryEngine.adBlockDetection','ext.wikia.aRecoveryEngine.adBlockRecovery',require.optional('ext.wikia.aRecoveryEngine.instartLogic.recovery')],function(adContext,adBlockDetection,adBlockRecovery,instartLogic){'use strict';function adIsRecoverable(extra){return extra&&(extra.isPageFairRecoverable||extra.isInstartLogicRecoverable);}function isRecoverableByPF(extra){return adBlockRecovery.isEnabled()&&adBlockDetection.isBlocking()&&adIsRecoverable(extra);}function isRecoverableByIL(){return instartLogic&&instartLogic.isEnabled()&&instartLogic.isBlocking();}function addTestPrefixForTestWiki(originalSrc,extra){if(adContext.get('opts.isAdTestWiki')){originalSrc=extra&&extra.testSrc?extra.testSrc:'test-'+originalSrc;}return originalSrc;}function get(originalSrc,extra){if(adContext.get(
'opts.premiumOnly')&&!adContext.get('opts.isAdTestWiki')){originalSrc='premium';}if(isRecoverableByPF(extra)||isRecoverableByIL()){originalSrc='rec';}return addTestPrefixForTestWiki(originalSrc,extra);}function getRecoverySrc(){return addTestPrefixForTestWiki('rec');}return{get:get,getRecoverySrc:getRecoverySrc};});;define('ext.wikia.adEngine.slot.slotTargeting',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.utils.math','wikia.abTest','wikia.instantGlobals',require.optional('ext.wikia.adEngine.wrappers.prebid')],function(adContext,math,abTest,instantGlobals,prebid){'use strict';var skins={mercury:'m',oasis:'o'},pageTypes={article:'a',home:'h'},slotSources={gpt:'1',mobile:'1',remnant:'2',mobile_remnant:'2',rec:'r',premium:'p'},wsiSlots={TOP_LEADERBOARD:'l',TOP_RIGHT_BOXAD:'m',INCONTENT_PLAYER:'i',INCONTENT_BOXAD_1:'f',BOTTOM_LEADERBOARD:'b',MOBILE_TOP_LEADERBOARD:'l',MOBILE_IN_CONTENT:'i',MOBILE_PREFOOTER:'p',MOBILE_BOTTOM_LEADERBOARD:'b'},videoBidders={appnexusAst:'aa',beachfront:
'bf',rubicon:'ru'},videoSlots={oasis:'INCONTENT_PLAYER',mercury:'MOBILE_IN_CONTENT'};function valueOrX(map,key){if(!key||!map[key]){return'x';}return map[key];}function getWikiaSlotId(slotName,slotSource){var context=adContext.getContext(),skin=valueOrX(skins,context.targeting.skin),slot=valueOrX(wsiSlots,slotName),pageType=valueOrX(pageTypes,context.targeting.pageType),src=valueOrX(slotSources,slotSource);return skin+slot+pageType+src;}function getAbTestId(slotData){var experimentId=instantGlobals.wgAdDriverAbTestIdTargeting,experiments=abTest.getExperiments(),id;experiments.forEach(function(experiment){if(experimentId===experiment.id){id=experiment.id+'_'+experiment.group.id;}});if(id){return id+slotData.wsi;}}function getOutstreamData(){var context=adContext.getContext(),getAdserverTargeting=prebid&&prebid.get().getAdserverTargetingForAdUnitCode,videoTargeting=getAdserverTargeting&&getAdserverTargeting(videoSlots[context.targeting.skin]);if(videoTargeting){return constructOutstreamString
(videoTargeting);}}function constructOutstreamString(videoTargeting){var bidderName=videoTargeting.hb_bidder,isVideoProvider=!!videoBidders[bidderName];if(isVideoProvider&&videoTargeting.hb_pb){return videoBidders[bidderName]+math.leftPad(parseFloat(videoTargeting.hb_pb)*100,4);}}return{getAbTestId:getAbTestId,getOutstreamData:getOutstreamData,getWikiaSlotId:getWikiaSlotId};});;define('ext.wikia.adEngine.utils.adLogicZoneParams',['ext.wikia.adEngine.adContext','wikia.log','wikia.location'],function(adContext,log,loc){'use strict';var calculated=!1,context={},hostname=loc.hostname,logGroup='ext.wikia.adEngine.utils.adLogicZoneParams',maxNumberOfCategories=3,site,zone1,zone2;function updateContext(){context=adContext.getContext();calculated=!1;}function getDomain(){var lhost,pieces,sld='',np;lhost=hostname.toLowerCase();pieces=lhost.split('.');np=pieces.length;if(pieces[np-2]==='co'){sld=pieces[np-3]+'.'+pieces[np-2]+'.'+pieces[np-1];}else{sld=pieces[np-2]+'.'+pieces[np-1];}return sld
.replace(/\./g,'');}function getHostnamePrefix(){var lhost=hostname.toLowerCase(),match=/(^|\.)(showcase|externaltest|preview|verify|stable|sandbox-[^\.]+)\./.exec(lhost);if(match&&match.length>2){return match[2];}var pieces=lhost.split('.');if(pieces.length){return pieces[0];}}function getVerticalName(targeting){if(getHostnamePrefix()==='showcase'||context.opts.showcase===true){return'showcase';}return targeting.mappedVerticalName;}function getRawDbName(){return'_'+(context.targeting.wikiDbName||'wikia').replace('/[^0-9A-Z_a-z]/','_');}function getAdLayout(params){var layout=params.pageType||'article';if(layout==='article'&&context.targeting.hasFeaturedVideo){layout='fv-'+layout;}return layout;}function calculateParams(){log('calculateParams','info',logGroup);var mappedVertical=getVerticalName(context.targeting);if(context.targeting.pageIsHub){site='hub';zone1='_'+mappedVertical+'_hub';zone2='hub';}else{site=mappedVertical;zone1=getRawDbName();zone2=getAdLayout(context.targeting);}
calculated=!0;log(['calculateParams',site,zone1,zone2],'info',logGroup);}function getSite(){if(!calculated){calculateParams();}return site;}function getName(){if(!calculated){calculateParams();}return zone1;}function getPageType(){if(!calculated){calculateParams();}return zone2;}function getVertical(){return context.targeting.wikiVertical;}function getPageCategories(){var categories=context.targeting.pageCategories,outCategories;if(categories instanceof Array&&categories.length>0){outCategories=categories.slice(0,maxNumberOfCategories);return outCategories.join('|').toLowerCase().replace(/ /g,'_').split('|');}}function getLanguage(){return context.targeting.wikiLanguage||'unknown';}function getWikiCategories(){return context.targeting.newWikiCategories;}updateContext();adContext.addCallback(updateContext);return{getDomain:getDomain,getHostnamePrefix:getHostnamePrefix,getSite:getSite,getName:getName,getPageType:getPageType,getVertical:getVertical,getPageCategories:getPageCategories,
getWikiCategories:getWikiCategories,getLanguage:getLanguage,getRawDbName:getRawDbName};});;define('ext.wikia.adEngine.utils.math',[],function(){'use strict';function getBucket(number,bucketSize){return parseInt(number/bucketSize,10)*bucketSize;}function leftPad(number,offset){var label=number+'';while(label.length<offset){label='0'+label;}return label;}return{getBucket:getBucket,leftPad:leftPad};});;define('ext.wikia.adEngine.utils.time',[],function(){'use strict';var MULTIPLIER={SECOND:1000,MINUTE:1000*60,HOUR:1000*60*60},UNITS={SECOND:['s','sec','second','seconds'],MINUTE:['m','min','minute','minutes'],HOUR:['h','hour','hours']};function getMultiplier(unit){if(getSupportedUnits().indexOf(unit)===-1){throw'Unsupported time unit';}var unitName=Object.keys(UNITS).filter(function(unitName){return UNITS[unitName].indexOf(unit)>-1;})[0];return MULTIPLIER[unitName];}function getInterval(value,unit){return value*getMultiplier(unit);}function getSupportedUnits(){return UNITS.SECOND.concat(
UNITS.MINUTE,UNITS.HOUR);}function guessTimeUnit(txt){var possibleResults=getSupportedUnits().filter(function(unit){return txt.indexOf(unit)>-1;});return possibleResults.length>0?possibleResults[possibleResults.length-1]:null;}function hasTimeUnit(txt){return guessTimeUnit(txt)!==null;}return{getInterval:getInterval,getSupportedUnits:getSupportedUnits,guessTimeUnit:guessTimeUnit,hasTimeUnit:hasTimeUnit};});;define('ext.wikia.adEngine.video.articleVideoAd',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.adEngine.video.vastUrlBuilder','ext.wikia.adEngine.slot.service.megaAdUnitBuilder','ext.wikia.adEngine.slot.service.srcProvider','ext.wikia.adEngine.video.player.jwplayer.adsTracking','ext.wikia.adEngine.video.vastDebugger','wikia.log'],function(adContext,slotsContext,vastUrlBuilder,megaAdUnitBuilder,srcProvider,adsTracking,vastDebugger,log){'use strict';var aspectRatio=640/480,baseSrc=adContext.get('targeting.skin')==='oasis'?'gpt':'mobile',
featuredVideoPassback='jwplayer',featuredVideoSlotName='FEATURED',logGroup='ext.wikia.adEngine.video.articleVideoAd';function calculateRV(depth){var capping=adContext.get('opts.fvAdsFrequency');return(depth<2||!capping)?1:(Math.floor((depth-1)/capping)+1);}function buildVastUrl(slotName,position,videoDepth,correlator,slotTargeting,playerMuted,bidParams){var options={correlator:correlator,vpos:position},slotParams=Object.assign({passback:featuredVideoPassback,pos:slotName,rv:calculateRV(videoDepth),src:srcProvider.get(baseSrc,{testSrc:'test'}),audio:playerMuted?'no':'yes'},slotTargeting);if(videoDepth===1&&bidParams){Object.keys(bidParams).forEach(function(key){slotParams[key]=bidParams[key];});}options.adUnit=megaAdUnitBuilder.build(slotParams.pos,slotParams.src,(playerMuted?'':'-audio'));log(['buildVastUrl',position,videoDepth,slotParams,options],log.levels.debug,logGroup);return vastUrlBuilder.build(aspectRatio,slotParams,options);}function shouldPlayAdOnNextVideo(depth){var capping=
adContext.get('opts.fvAdsFrequency');return adContext.get('opts.replayAdsForFV')&&capping>0&&(depth-1)%capping===0;}function canAdBePlayed(depth){var isReplay=depth>1,adCanBePlayed=!isReplay||(isReplay&&shouldPlayAdOnNextVideo(depth)),slotIsEnabled=slotsContext.isApplicable(featuredVideoSlotName);return slotIsEnabled&&adCanBePlayed;}function shouldPlayPreroll(videoDepth){return canAdBePlayed(videoDepth);}function shouldPlayMidroll(videoDepth){return adContext.get('opts.isFVMidrollEnabled')&&canAdBePlayed(videoDepth);}function shouldPlayPostroll(videoDepth){return adContext.get('opts.isFVPostrollEnabled')&&canAdBePlayed(videoDepth);}return{buildVastUrl:buildVastUrl,shouldPlayPreroll:shouldPlayPreroll,shouldPlayMidroll:shouldPlayMidroll,shouldPlayPostroll:shouldPlayPostroll};});;define('ext.wikia.adEngine.video.player.playerTracker',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adLogicPageParams','ext.wikia.adEngine.adTracker','ext.wikia.adEngine.slot.slotTargeting',
'wikia.browserDetect','wikia.geo','wikia.log','wikia.window',require.optional('ext.wikia.adEngine.lookup.prebid.bidHelper'),require.optional('ext.wikia.adEngine.video.player.porvata.floater')],function(adContext,pageLevel,adTracker,slotTargeting,browserDetect,geo,log,win,bidHelper,floater){'use strict';var context=adContext.getContext(),logGroup='ext.wikia.adEngine.video.player.playerTracker',emptyValue={int:0,string:'(none)',price:-1};function isEnabled(){return!!context.opts.playerTracking;}function prepareData(params,playerName,eventName,errorCode,contentType){var pageLevelParams=pageLevel.getPageLevelParams(),canFloat=floater&&floater.canFloat(params)?'canFloat':'',floatingState=(params.floatingContext&&params.floatingContext.state)||(canFloat?'never':''),trackingData={'pv_unique_id':win.pvUID,'pv_number':pageLevelParams.pv,'country':geo.getCountryCode(),'timestamp':(new Date()).getTime(),'skin':pageLevelParams.skin,'wsi':params.src?slotTargeting.getWikiaSlotId(params.slotName,
params.src):emptyValue.string,'player':playerName,'ad_product':params.adProduct,'position':params.slotName||emptyValue.string,'event_name':eventName,'ad_error_code':errorCode||emptyValue.int,'content_type':params.contentType||contentType||emptyValue.string,'line_item_id':params.lineItemId||emptyValue.int,'creative_id':params.creativeId||emptyValue.int,'audio':params.withAudio?1:0,'price':emptyValue.price,'browser':[browserDetect.getOS(),browserDetect.getBrowser()].join(' '),'additional_1':canFloat,'additional_2':floatingState};if(bidHelper&&params.bid){if(params.bid.bidderCode==='rubicon'){trackingData['vast_id']=[params.bid.rubiconAdvertiserId||emptyValue.string,params.bid.rubiconAdId||emptyValue.string].join(':');trackingData['price']=bidHelper.transformPriceFromBid(params.bid);}if(params.bid.bidderCode==='appnexusAst'||params.bid.bidderCode==='beachfront'){trackingData['vast_id']=params.bid.creative_id||emptyValue.string;trackingData['price']=bidHelper.transformPriceFromBid(params.
bid);}}return trackingData;}function track(params,playerName,eventName,errorCode,contentType){if(!isEnabled()||params.trackingDisabled){log(['track','Tracking disabled',params],log.levels.debug,logGroup);return;}if(!params.adProduct||!playerName||!eventName){log(['track','Missing argument',params.adProduct,playerName,eventName],log.levels.debug,logGroup);return;}var data=prepareData(params,playerName,eventName,errorCode,contentType);log(['track',data],log.levels.debug,logGroup);adTracker.trackDW(data,'adengplayerinfo');return data;}return{isEnabled:isEnabled,track:track};});;define('ext.wikia.adEngine.video.vastDebugger',['ext.wikia.adEngine.video.vastParser'],function(vastParser){'use strict';function setAttribute(element,attribute,value){if(!element||!value){return;}element.setAttribute(attribute,value);}function setVastAttributes(element,vastUrl,status,imaAd){var vastParams=vastParser.parse(vastUrl,{imaAd:imaAd});setAttribute(element,'data-vast-content-type',vastParams.contentType);
setAttribute(element,'data-vast-creative-id',vastParams.creativeId);setAttribute(element,'data-vast-line-item-id',vastParams.lineItemId);setAttribute(element,'data-vast-position',vastParams.position);setAttribute(element,'data-vast-size',vastParams.size);setAttribute(element,'data-vast-status',status);setAttribute(element,'data-vast-params',JSON.stringify(vastParams.customParams));}return{setVastAttributes:setVastAttributes};});;define('ext.wikia.adEngine.video.vastParser',['wikia.log','wikia.querystring'],function(log,Querystring){'use strict';var logGroup='ext.wikia.adEngine.video.vastParser';function getAdInfo(imaAd){var adInfo={},wrapperCreativeIds,wrapperIds;if(imaAd){adInfo.lineItemId=imaAd.getAdId();adInfo.creativeId=imaAd.getCreativeId();adInfo.contentType=imaAd.getContentType();wrapperIds=imaAd.getWrapperAdIds();if(wrapperIds.length){adInfo.lineItemId=wrapperIds[0];}wrapperCreativeIds=imaAd.getWrapperCreativeIds();if(wrapperCreativeIds.length){adInfo.creativeId=
wrapperCreativeIds[0];}}return adInfo;}function parse(vastUrl,extra){extra=extra||{};var adInfo,currentAd=getAdInfo(extra.imaAd),vastParams=new Querystring(vastUrl),customParams=encodeURI('?'+vastParams.getVal('cust_params',''));adInfo={contentType:currentAd.contentType||extra.contentType,creativeId:currentAd.creativeId||extra.creativeId,customParams:new Querystring(customParams).getVals(),lineItemId:currentAd.lineItemId||extra.lineItemId,position:vastParams.getVal('vpos',null),size:vastParams.getVal('sz',null)};log(['Parse VAST url',adInfo],log.levels.debug,logGroup);return adInfo;}return{getAdInfo:getAdInfo,parse:parse};});;define('ext.wikia.adEngine.video.vastUrlBuilder',['ext.wikia.adEngine.adLogicPageParams','ext.wikia.adEngine.slot.adUnitBuilder','ext.wikia.adEngine.slot.slotTargeting','wikia.location','wikia.log'],function(page,adUnitBuilder,slotTargeting,loc,log){'use strict';var adSizes={vertical:'320x480',horizontal:'640x480'},availableVideoPositions=['preroll','midroll',
'postroll'],baseUrl='https://pubads.g.doubleclick.net/gampad/ads?',logGroup='ext.wikia.adEngine.video.vastUrlBuilder';function getCustomParameters(slotParams){var customParameters,params=page.getPageLevelParams(),wsi=slotTargeting.getWikiaSlotId(slotParams.pos,slotParams.src);customParameters=['wsi='+wsi];Object.keys(params).forEach(function(key){if(params[key]){customParameters.push(key+'='+params[key]);}});Object.keys(slotParams).forEach(function(key){if(slotParams[key]){customParameters.push(key+'='+slotParams[key]);}});return encodeURIComponent(customParameters.join('&'));}function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n);}function getSizeByAspectRatio(aspectRatio){return aspectRatio>=1||!isNumeric(aspectRatio)?adSizes.horizontal:adSizes.vertical;}function getAdUnit(options,slotParams){return options.adUnit||adUnitBuilder.build(slotParams.pos,slotParams.src);}function build(aspectRatio,slotParams,options){options=options||{};slotParams=slotParams||{};var correlator=
options.correlator||Math.round(Math.random()*10000000000),params,url;params=['output=vast','env=vp','gdfp_req=1','impl=s','unviewed_position_start=1','iu='+getAdUnit(options,slotParams),'sz='+getSizeByAspectRatio(aspectRatio),'url='+encodeURIComponent(loc.href),'description_url='+encodeURIComponent(loc.href),'correlator='+correlator,'cust_params='+getCustomParameters(slotParams)];if(typeof options.numberOfAds!=='undefined'){params.push('pmad='+options.numberOfAds);}if(options.vpos&&availableVideoPositions.indexOf(options.vpos)>-1){params.push('vpos='+options.vpos);}if(options.contentSourceId&&options.videoId){params.push('cmsid='+options.contentSourceId);params.push('vid='+options.videoId);}url=baseUrl+params.join('&');log(['build',url],'debug',logGroup);return url;}return{build:build};});;define('ext.wikia.adEngine.video.videoFrequencyMonitor',['ext.wikia.adEngine.video.videoFrequencySettings','ext.wikia.adEngine.video.videoFrequencyStore','wikia.window'],function(settings,store,win){
'use strict';function prepareData(){return{date:new Date().getTime(),pv:win.pvNumber};}function registerLaunchedVideo(){store.save(prepareData());}function videoCanBeLaunched(){var limits=settings.get(),result=!0;limits.pv.forEach(function(rule){result=result&&store.numberOfVideosSeenInLastPageViews(rule.limit)<rule.frequency;});limits.time.forEach(function(rule){result=result&&store.numberOfVideosSeenInTime(rule.limit,rule.unit)<rule.frequency;});return result;}return{registerLaunchedVideo:registerLaunchedVideo,videoCanBeLaunched:videoCanBeLaunched};});;define('ext.wikia.adEngine.video.videoFrequencySettings',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.utils.time'],function(adContext,timeUtil){'use strict';var context=adContext.getContext();function get(){return{pv:parsePV(),time:parseTime()};}function parseTime(){if(!context.opts.outstreamVideoFrequencyCapping){return[];}return context.opts.outstreamVideoFrequencyCapping.filter(function(item){return timeUtil.hasTimeUnit(
item)&&validate(item);}).map(parseTimeRule);}function validate(item){return item.match('^[0-9]+\/[0-9]+[a-z]+$');}function parsePV(){if(!context.opts.outstreamVideoFrequencyCapping){return[];}return context.opts.outstreamVideoFrequencyCapping.filter(function(item){return item.indexOf('pv')>-1&&validate(item);}).map(function(item){var data=item.replace('pv','').split('/');return{frequency:parseInt(data[0]),limit:parseInt(data[1])};});}function parseTimeRule(item){var unit=timeUtil.guessTimeUnit(item),data=item.replace(unit,'').split('/');return{frequency:parseInt(data[0]),limit:parseInt(data[1]),unit:unit};}function getRequiredNumberOfItems(){if(!context.opts.outstreamVideoFrequencyCapping||context.opts.outstreamVideoFrequencyCapping.length===0){return 0;}var max=Math.max.apply(null,context.opts.outstreamVideoFrequencyCapping.map(function(value){return parseInt(value.split('/')[0],10);}));return max?max:0;}return{get:get,getRequiredNumberOfItems:getRequiredNumberOfItems};});;define(
'ext.wikia.adEngine.video.videoFrequencyStore',['ext.wikia.adEngine.utils.time','ext.wikia.adEngine.video.videoFrequencySettings','wikia.cache','wikia.log','wikia.window'],function(timeUtil,settings,cache,log,win){'use strict';var cacheKey='adEngine_outstreamVideoFrequency',cacheTtl=cache.CACHE_STANDARD,store=[],logGroup='ext.wikia.adEngine.video.videoFrequencyStore';function removeNotNeededData(data){var requiredNoOfItems=settings.getRequiredNumberOfItems();data.sort(function(a,b){return a.date-b.date;});if(data.length>requiredNoOfItems){data=data.slice(-requiredNoOfItems);}return data;}function save(data){store=getAll();log(['Data retrived from cache',store],log.levels.debug,logGroup);store.push(data);store=removeNotNeededData(store);cache.set(cacheKey,store,cacheTtl);log(['Data saved in cache',store,cacheKey,cacheTtl],log.levels.debug,logGroup);}function countAll(filterFunction){store=getAll();return(filterFunction?store.filter(filterFunction):store).length;}function
numberOfVideosSeenInLastPageViews(numberOfCheckedPageViews){var minPV=win.pvNumber-numberOfCheckedPageViews;log(['minPV calculated',minPV],log.levels.debug,logGroup);return countAll(function(item){return item.pv>minPV;});}function numberOfVideosSeenInTime(value,unit){var minDate=(new Date()).getTime()-timeUtil.getInterval(value,unit);log(['minDate calculated',minDate],log.levels.debug,logGroup);return countAll(function(item){return item.date>minDate;});}function isValidData(value){var date,pv;if(value.date&&value.pv){date=parseInt(value.date,10);pv=parseInt(value.pv,10);if(date>0&&pv>0){return true;}}return false;}function getAll(){var cachedData=cache.get(cacheKey)||store;return cachedData.filter(isValidData);}return{getAll:getAll,numberOfVideosSeenInTime:numberOfVideosSeenInTime,numberOfVideosSeenInLastPageViews:numberOfVideosSeenInLastPageViews,save:save};});;define('ext.wikia.aRecoveryEngine.adBlockDetection',['ext.wikia.adEngine.adContext','wikia.document','wikia.instantGlobals',
'wikia.lazyqueue','wikia.log',require.optional('ext.wikia.aRecoveryEngine.pageFair.recovery')],function(adContext,doc,instantGlobals,lazyQueue,log,pageFair){'use strict';var cb=function(callback){callback();},logGroup='ext.wikia.aRecoveryEngine.adBlockDetection',onBlockingEventsQueue=lazyQueue.makeQueue([],cb),onNotBlockingEventsQueue=lazyQueue.makeQueue([],cb);function addOnBlockingCallback(callback){onBlockingEventsQueue.push(callback);}function addOnNotBlockingCallback(callback){onNotBlockingEventsQueue.push(callback);}function isBlocking(){return isEnabled()&&pageFair&&pageFair.isBlocking();}function isEnabled(){var context=adContext.getContext();log(['isEnabled',context.opts.pageFairRecovery],log.levels.debug,logGroup);return context.opts.pageFairRecovery;}return{addOnBlockingCallback:addOnBlockingCallback,addOnNotBlockingCallback:addOnNotBlockingCallback,isBlocking:isBlocking,isEnabled:isEnabled};});;define('ext.wikia.aRecoveryEngine.adBlockRecovery',[
'ext.wikia.adEngine.adContext','ext.wikia.aRecoveryEngine.adBlockDetection','wikia.document','wikia.instantGlobals','wikia.log','wikia.window'],function(adContext,adBlockDetection,doc,instantGlobals,log,win){'use strict';var customLogEndpoint='/wikia.php?controller=ARecoveryEngineApi&method=getLogInfo&kind=',logGroup='ext.wikia.aRecoveryEngine.adBlockRecovery';function getName(){return'adBlockRecovery';}function addResponseListener(callback){adBlockDetection.addOnBlockingCallback(callback);adBlockDetection.addOnNotBlockingCallback(callback);}function isEnabled(){var context=adContext.getContext(),enabled=context.opts.pageFairRecovery||context.opts.instartLogicRecovery;log(['isEnabled',enabled],log.levels.debug,logGroup);return enabled;}function track(type){if(win._sp_&&!win._sp_.trackingSent){if(Wikia&&Wikia.Tracker){Wikia.Tracker.track({eventName:'ads.recovery',category:'ads-recovery-blocked',action:Wikia.Tracker.ACTIONS.IMPRESSION,label:type,trackingMethod:'analytics'});}if(
instantGlobals.wgARecoveryEngineCustomLog){sendCustomLog(type);}win._sp_.trackingSent=!0;}}function sendCustomLog(type){var xmlHttp=new XMLHttpRequest();try{xmlHttp.open('GET',customLogEndpoint+type,true);xmlHttp.send();}catch(e){log(['track',e],log.levels.error,logGroup);}}function verifyContent(){var wikiaArticle=doc.getElementById('WikiaArticle'),display=wikiaArticle.currentStyle?wikiaArticle.currentStyle.display:getComputedStyle(wikiaArticle,null).display;if(display==='none'){track('css-display-none');}}return{addResponseListener:addResponseListener,isEnabled:isEnabled,getName:getName,track:track,verifyContent:verifyContent,wasCalled:isEnabled};});;define('ext.wikia.aRecoveryEngine.pageFair.recovery',['ext.wikia.adEngine.adContext','wikia.log','wikia.window'],function(adContext,log,win){'use strict';var logGroup='ext.wikia.aRecoveryEngine.pageFair.recovery',context=adContext.getContext(),recoverableSlots=['TOP_LEADERBOARD','TOP_RIGHT_BOXAD','BOTTOM_LEADERBOARD'];function isEnabled
(){var enabled=!!context.opts.pageFairRecovery;log(['isEnabled',enabled,log.levels.debug,logGroup]);return enabled;}function isSlotRecoverable(slotName){var result=isEnabled()&&recoverableSlots.indexOf(slotName)!==-1;log(['isSlotRecoverable',result],log.levels.info,logGroup);return result;}function isBlocking(){var isBlocking=!!(win.ads&&win.ads.runtime.pf&&win.ads.runtime.pf.recovering);log(['isBlocking',isBlocking],log.levels.debug,logGroup);return isBlocking;}function addMarker(slotElement){slotElement.setAttribute('adonis-marker','');}return{isBlocking:isBlocking,isEnabled:isEnabled,isSlotRecoverable:isSlotRecoverable,addMarker:addMarker};});;define('wikia.browserDetect',['wikia.window'],function(win){'use strict';var appName=win.navigator.appName,userAgent=win.navigator.userAgent,browser=null,operatingSystem=null;function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);}function isIE(){var bool=!1;if(appName===
'Microsoft Internet Explorer'||(appName==='Netscape'&&userAgent.indexOf('Trident/')!==-1)){bool=!0;}return bool;}function isEdge(){return userAgent.indexOf('Edge')!==-1;}function isFirefox(){return userAgent.toLowerCase().indexOf('firefox')>-1;}function isChrome(){return userAgent.toLowerCase().indexOf('chrome')>-1;}function isIPad(){var bool=!1;if(userAgent.match(/iPad/i)!==null){bool=!0;}return bool;}function isIOS7orLower(){return!!userAgent.match(/iPad.+OS.[6,7].\d.+like.Mac.OS.+Safari/i);}function isAndroid(){return userAgent.toLowerCase().indexOf('android')>-1;}function getOS(){if(null!==operatingSystem){return operatingSystem;}operatingSystem='unknown';if(userAgent.indexOf('Win')!==-1){operatingSystem='Windows';}if(userAgent.indexOf('Mac')!==-1){operatingSystem='OSX';}if(userAgent.indexOf('Linux')!==-1){operatingSystem='Linux';}if(userAgent.indexOf('Android')!==-1){operatingSystem='Android';}if(userAgent.indexOf('like Mac')!==-1){operatingSystem='iOS';}return operatingSystem
;}function getBrowser(){if(null!==browser){return browser;}var appVersion=win.navigator.appVersion,temp,matches=userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(matches[1])){temp=/\brv[ :]+(\d+)/g.exec(userAgent)||[];browser='IE '+(temp[1]||'');return browser;}if(matches[1]==='Chrome'){temp=userAgent.match(/\b(OPR|Edge)\/(\d+)/);if(temp!==null){browser=temp.slice(1).join(' ').replace('OPR','Opera');return browser;}}matches=matches[2]?[matches[1],matches[2]]:[appName,appVersion,'-?'];temp=userAgent.match(/version\/(\d+)/i);if(temp!==null){matches.splice(1,1,temp[1]);}browser=matches.join(' ');return browser;}function getBrowserVersion(){var browserStringParts=getBrowser().split(' ');return parseInt(browserStringParts[1],10);}return{getBrowser:getBrowser,getBrowserVersion:getBrowserVersion,getOS:getOS,isChrome:isChrome,isIE:isIE,isFirefox:isFirefox,isIPad:isIPad,isIOS7orLower:isIOS7orLower,isAndroid:isAndroid,isMobile:isMobile,isEdge:
isEdge};});;window.Krux||((Krux=function(){Krux.q.push(arguments);}).q=[]);define('wikia.krux',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adTracker','wikia.document','wikia.tracker','wikia.window'],function(adContext,adTracker,doc,wikiaTracker,win){'use strict';var maxNumberOfKruxSegments=50,kruxScriptId='krux-control-tag',kruxLoaded=!1,segmentsCountTracked=!1;function exportPageParams(adLogicPageParams){var params,value;if(Object.keys){params=adLogicPageParams.getPageLevelParams();Object.keys(params).forEach(function(key){value=params[key];if(value){win['kruxDartParam_'+key]=value.toString();}});}}function addConfigScript(confid){var k,s;k=document.createElement('script');k.type='text/javascript';k.id=kruxScriptId;k.async=!0;k.src=(location.protocol==='https:'?'https:':'http:')+'//cdn.krxd.net/controltag?confid='+confid;s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);}function load(confid){require(['ext.wikia.adEngine.adContext',
'ext.wikia.adEngine.adLogicPageParams'],function(adContext,adLogicPageParams){var script;if(adContext.getContext().targeting.enableKruxTargeting){exportPageParams(adLogicPageParams);script=doc.getElementById(kruxScriptId);if(script){script.parentNode.removeChild(script);}addConfigScript(confid);kruxLoaded=!0;adTracker.track('krux/load');wikiaTracker.track({category:'ads-trackers',action:'krux',label:'load',value:0,trackingMethod:'analytics'});}});}function getParams(n){var k='kx'+n;try{if(win.localStorage){return win.localStorage[k]||'';}else{return'';}}catch(e){return'';}}function trackNumberOfSegments(numberOfSegments){if(segmentsCountTracked){return;}var label=numberOfSegments+'';while(label.length<4){label='0'+label;}adTracker.track('krux/segments_count',{},numberOfSegments,label);segmentsCountTracked=!0;}function getSegments(){var segments=getParams('segs'),segsArray;if(segments===''){trackNumberOfSegments(0);return[];}segsArray=segments.split(',');trackNumberOfSegments(
segsArray.length);return segsArray.slice(0,maxNumberOfKruxSegments);}function getUser(){return getParams('user');}function sendEvent(eventId,data){if(!kruxLoaded){return false;}Krux('admEvent',eventId,data||{});return true;}adContext.addCallback(function(){segmentsCountTracked=!1;});return{load:load,getSegments:getSegments,getUser:getUser,sendEvent:sendEvent};});;define('wikia.promise',['wikia.window'],function(win){'use strict';var P=win.Promise||{};P.createWithTimeout=function(f,msToTimeout){msToTimeout=msToTimeout||2000;var timeout=new P(function(resolve,reject){setTimeout(reject,msToTimeout);});return P.race([new P(f),timeout]);};return P;});;

define('ext.wikia.adEngine.lookup.a9',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.adEngine.lookup.lookupFactory','wikia.document','wikia.log','wikia.window'],function(adContext,slotsContext,factory,doc,log,win){'use strict';var logGroup='ext.wikia.adEngine.lookup.a9',config={oasis:{BOTTOM_LEADERBOARD:[[728,90],[970,250]],INCONTENT_BOXAD_1:[[300,250],[300,600]],TOP_LEADERBOARD:[[728,90],[970,250]],TOP_RIGHT_BOXAD:[[300,250],[300,600]]},mercury:{MOBILE_IN_CONTENT:[[300,250],[320,480]],MOBILE_PREFOOTER:[[320,50],[300,250]],MOBILE_TOP_LEADERBOARD:[[320,50]]}},VIDEO_SLOTS=['FEATURED'],amazonId='3115',bids={},loaded=!1,priceMap={},slots=[];function insertScript(){var a9Script=doc.createElement('script'),node=doc.getElementsByTagName('script')[0];a9Script.type='text/javascript';a9Script.async=!0;a9Script.src='//c.amazon-adsystem.com/aax2/apstag.js';node.parentNode.insertBefore(a9Script,node);}function isVideoBidderEnabled(){return adContext.get(
'bidders.a9Video')&&adContext.get('targeting.hasFeaturedVideo');}function call(skin,onResponse){var a9Slots;if(!loaded){log(['call - load',skin],'debug',logGroup);insertScript();configureApstag();win.apstag.init({pubID:amazonId,videoAdServer:'DFP'});loaded=!0;}bids={};priceMap={};slots=slotsContext.filterSlotMap(config[skin]);a9Slots=Object.keys(slots).map(createSlotDefinition);if(isVideoBidderEnabled()){a9Slots=a9Slots.concat(VIDEO_SLOTS.map(createVideoSlotDefinition));}log(['call - fetchBids',a9Slots],'debug',logGroup);win.apstag.fetchBids({slots:a9Slots,timeout:2000},function(currentBids){log(['call - fetchBids response',currentBids],'debug',logGroup);currentBids.forEach(function(bid){bids[bid.slotID]=bid;});onResponse();});}function createSlotDefinition(slotName){return{sizes:slots[slotName],slotID:slotName,slotName:slotName};}function createVideoSlotDefinition(videoSlotName){return{slotID:videoSlotName,mediaType:'video'};}function configureApstagCommand(command,args){win.apstag.
_Q.push([command,args]);}function configureApstag(){win.apstag=win.apstag||{};win.apstag._Q=win.apstag._Q||[];if(typeof win.apstag.init==='undefined'){win.apstag.init=function(){configureApstagCommand('i',arguments);};}if(typeof win.apstag.fetchBids==='undefined'){win.apstag.fetchBids=function(){configureApstagCommand('f',arguments);};}}function calculatePrices(){log(['calculatePrices',bids],'debug',logGroup);Object.keys(bids).forEach(function(slotName){priceMap[slotName]=bids[slotName].amznbid;});}function encodeParamsForTracking(params){return params.amznsz+';'+params.amznbid;}function getSlotParams(slotName){var bid=bids[slotName];log(['getSlotParams',slotName],'debug',logGroup);if(!bid){return{};}return{amznbid:bid.amznbid,amzniid:bid.amzniid,amznsz:bid.amznsz,amznp:bid.amznp};}function getPrices(){return priceMap;}function isSlotSupported(slotName){return slots[slotName]||VIDEO_SLOTS.indexOf(slotName)>=0;}function getBestSlotPrice(slotName){return priceMap[slotName]?{a9:priceMap[
slotName]}:{};}return factory.create({logGroup:logGroup,name:'a9',call:call,calculatePrices:calculatePrices,getPrices:getPrices,isSlotSupported:isSlotSupported,encodeParamsForTracking:encodeParamsForTracking,getSlotParams:getSlotParams,getBestSlotPrice:getBestSlotPrice});});;

define('ext.wikia.adEngine.lookup.prebid.bidHelper',['ext.wikia.adEngine.lookup.prebid.priceGranularityHelper'],function(priceGranularityHelper){'use strict';function transformPriceFromBid(bid){var maxSupportedCpm=20;return priceGranularityHelper.transformPriceFromCpm(bid.cpm,maxSupportedCpm);}return{transformPriceFromBid:transformPriceFromBid};});;define('ext.wikia.adEngine.lookup.prebid',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.lookup.prebid.adaptersPerformanceTracker','ext.wikia.adEngine.lookup.prebid.adaptersPricesTracker','ext.wikia.adEngine.lookup.prebid.adaptersRegistry','ext.wikia.adEngine.lookup.prebid.prebidHelper','ext.wikia.adEngine.lookup.prebid.prebidSettings','ext.wikia.adEngine.lookup.lookupFactory','wikia.document','wikia.window'],function(adContext,performanceTracker,pricesTracker,adaptersRegistry,helper,settings,factory,doc,win){'use strict';var adUnits=[],biddersPerformanceMap={},prebidLoaded=!1;function removeAdUnits(){(win.pbjs.adUnits||[]).forEach(
function(adUnit){win.pbjs.removeAdUnit(adUnit.code);});}function call(skin,onResponse){var prebid,node;if(!prebidLoaded){prebid=doc.createElement('script');node=doc.getElementsByTagName('script')[0];adaptersRegistry.setupCustomAdapters();adaptersRegistry.registerAliases();prebid.async=!0;prebid.type='text/javascript';prebid.src=adContext.getContext().opts.prebidBidderUrl||'//acdn.adnxs.com/prebid/prebid.js';node.parentNode.insertBefore(prebid,node);}biddersPerformanceMap=performanceTracker.setupPerformanceMap(skin);adUnits=helper.setupAdUnits(skin);if(win.pbjs){win.pbjs._bidsReceived=[];}if(adUnits.length>0){if(!prebidLoaded){win.pbjs.que.push(function(){win.pbjs.bidderSettings=settings.create();});}win.pbjs.que.push(function(){removeAdUnits();win.pbjs.requestBids({adUnits:adUnits,bidsBackHandler:onResponse});});}prebidLoaded=!0;}function calculatePrices(){biddersPerformanceMap=performanceTracker.updatePerformanceMap(biddersPerformanceMap);}function trackAdaptersOnLookupEnd(){var
adapters=adaptersRegistry.getAdapters();biddersPerformanceMap=performanceTracker.updatePerformanceMap(biddersPerformanceMap);adapters.forEach(function(adapter){performanceTracker.trackBidderOnLookupEnd(adapter,biddersPerformanceMap);});}function trackAdaptersSlotState(providerName,slotName){var adapters=adaptersRegistry.getAdapters();biddersPerformanceMap=performanceTracker.updatePerformanceMap(biddersPerformanceMap);adapters.forEach(function(adapter){performanceTracker.trackBidderSlotState(adapter,slotName,providerName,biddersPerformanceMap);});}function isSlotSupported(slotName){return adUnits.some(function(adUnit){return adUnit.code===slotName;});}function getSlotParams(slotName){var slotParams;if(win.pbjs&&typeof win.pbjs.getBidResponses==='function'){var params=win.pbjs.getBidResponses(slotName)||{};if(params&&params[slotName]&&params[slotName].bids&&params[slotName].bids.length){var bidParams,priorities=adaptersRegistry.getPriorities();params[slotName].bids.forEach(function(param
){if(!bidParams){bidParams=param;}else{if(bidParams.cpm===param.cpm){if(priorities[bidParams.bidder]===priorities[param.bidder]){bidParams=bidParams.timeToRespond>param.timeToRespond?param:bidParams;}else{bidParams=priorities[bidParams.bidder]<priorities[param.bidder]?param:bidParams;}}else{bidParams=bidParams.cpm<param.cpm?param:bidParams;}}});slotParams=bidParams.adserverTargeting;}}return slotParams||{};}function getBestSlotPrice(slotName){return pricesTracker.getSlotBestPrice(slotName);}return factory.create({logGroup:'ext.wikia.adEngine.lookup.prebid',name:'prebid',call:call,calculatePrices:calculatePrices,isSlotSupported:isSlotSupported,getSlotParams:getSlotParams,getBestSlotPrice:getBestSlotPrice,trackAdaptersOnLookupEnd:trackAdaptersOnLookupEnd,trackAdaptersSlotState:trackAdaptersSlotState});});;define('ext.wikia.adEngine.lookup.prebid.prebidHelper',['ext.wikia.adEngine.lookup.prebid.adaptersRegistry','ext.wikia.aRecoveryEngine.instartLogic.recovery'],function(adaptersRegistry,
instartLogic){'use strict';var adUnits=[];function getAdapterAdUnits(adapter,skin){var adapterAdUnits=[],isRecovering=instartLogic.isBlocking(),slots=adapter.getSlots(skin,isRecovering);Object.keys(slots).forEach(function(slotName){var adUnit=adapter.prepareAdUnit(slotName,slots[slotName],skin,isRecovering);if(adUnit){adapterAdUnits.push(adUnit);}});return adapterAdUnits;}function addAdUnits(adapterAdUnits){adapterAdUnits.forEach(function(adUnit){adUnits.push(adUnit);});}function setupAdUnits(skin){var adapters=adaptersRegistry.getAdapters();adUnits=[];adapters.forEach(function(adapter){if(adapter&&adapter.isEnabled()){addAdUnits(getAdapterAdUnits(adapter,skin));}});return adUnits;}return{setupAdUnits:setupAdUnits};});;define('ext.wikia.adEngine.lookup.prebid.prebidSettings',['ext.wikia.adEngine.lookup.prebid.bidHelper'],function(bidHelper){'use strict';function create(){return{standard:{alwaysUseBid:!1,adserverTargeting:[{key:"hb_bidder",val:function(bidResponse){return bidResponse
.bidderCode;}},{key:"hb_adid",val:function(bidResponse){return bidResponse.adId;}},{key:"hb_pb",val:function(bidResponse){return bidHelper.transformPriceFromBid(bidResponse);}},{key:'hb_size',val:function(bidResponse){return bidResponse.size;}}]}}}return{create:create};});;define('ext.wikia.adEngine.lookup.prebid.priceGranularityHelper',function(){'use strict';function transformPriceFromCpm(cpm,maxSupportedCpm){var defaultMaxCpm=20,result;if(typeof maxSupportedCpm==='undefined'||maxSupportedCpm<defaultMaxCpm){maxSupportedCpm=defaultMaxCpm;}result=Math.floor(maxSupportedCpm).toFixed(2);if(cpm===0){result='0.00';}else if(cpm<0.05){result='0.01';}else if(cpm<5.00){result=(Math.floor(cpm*20)/20).toFixed(2);}else if(cpm<10.00){result=(Math.floor(cpm*10)/10).toFixed(2);}else if(cpm<20.00){result=(Math.floor(cpm*2)/2).toFixed(2);}else if(cpm<maxSupportedCpm){result=Math.floor(cpm).toFixed(2);}return result;}return{transformPriceFromCpm:transformPriceFromCpm};});;define(
'ext.wikia.adEngine.lookup.prebid.adaptersHelper',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.utils.adLogicZoneParams',],function(adContext,adLogicZoneParams){'use strict';function getAdContext(){return adContext.getContext();}function getTargeting(slotName,skin){var provider=skin==='oasis'?'gpt':'mobile',s1=getAdContext().targeting.wikiIsTop1000?adLogicZoneParams.getName():'not a top1k wiki';return{pos:[slotName],src:[provider],s0:[adLogicZoneParams.getSite()],s1:[s1],s2:[adLogicZoneParams.getPageType()],lang:[adLogicZoneParams.getLanguage()]};}return{getTargeting:getTargeting};});;define('ext.wikia.adEngine.lookup.prebid.adaptersPerformanceTracker',['ext.wikia.adEngine.adTracker','ext.wikia.adEngine.lookup.prebid.adaptersRegistry','ext.wikia.adEngine.lookup.prebid.bidHelper','ext.wikia.adEngine.utils.timeBuckets','ext.wikia.adEngine.wrappers.prebid'],function(adTracker,adaptersRegistry,bidHelper,timeBuckets,prebid){'use strict';var buckets=[0.0,0.5,1.0,1.5,2.0,2.5,3.0],
emptyResponseMsg='EMPTY_RESPONSE',notRespondedMsg='NO_RESPONSE';function setupPerformanceMap(skin){var biddersPerformanceMap={},adapters=adaptersRegistry.getAdapters();adapters.forEach(function(adapter){var slots=adapter.getSlots(skin),adapterName=adapter.getName();if(adapter.isEnabled()){biddersPerformanceMap[adapterName]={};Object.keys(slots).forEach(function(slotName){biddersPerformanceMap[adapterName][slotName]=notRespondedMsg;});}});return biddersPerformanceMap;}function updatePerformanceMap(performanceMap){var allBids;if(typeof prebid.get().getBidResponses==='function'){allBids=prebid.get().getBidResponses();Object.keys(allBids).forEach(function(slotName){var slotBids=allBids[slotName].bids;slotBids.forEach(function(bid){performanceMap[bid.bidder][slotName]=getParamsFromBidForTracking(bid);});});}return performanceMap;}function trackBidderSlotState(adapter,slotName,providerName,performanceMap){var bidderName=adapter.getName(),category;if(!adapter.isEnabled()){return;}if(!
performanceMap[bidderName][slotName]){return;}if(performanceMap[bidderName][slotName]!==notRespondedMsg){category=bidderName+'/lookup_success/'+providerName;adTracker.track(category,slotName,0,performanceMap[bidderName][slotName]);}else{category=bidderName+'/lookup_error/'+providerName;adTracker.track(category,slotName,0,'nodata');}}function trackBidderOnLookupEnd(adapter,performanceMap){var bidderName=adapter.getName();if(adapter.isEnabled()){adTracker.track(bidderName+'/lookup_end',performanceMap[bidderName],0,'nodata');}}function getParamsFromBidForTracking(bid){var bucket=timeBuckets.getTimeBucket(buckets,bid.timeToRespond/1000);if(bid.getStatusCode()===prebid.errorResponseStatusCode){return[emptyResponseMsg,bucket].join(';');}return[bid.getSize(),bidHelper.transformPriceFromBid(bid),bucket].join(';');}return{setupPerformanceMap:setupPerformanceMap,trackBidderOnLookupEnd:trackBidderOnLookupEnd,trackBidderSlotState:trackBidderSlotState,updatePerformanceMap:updatePerformanceMap};});;
define('ext.wikia.adEngine.lookup.prebid.adaptersPricesTracker',['ext.wikia.adEngine.lookup.prebid.adaptersRegistry','ext.wikia.adEngine.lookup.prebid.bidHelper','ext.wikia.adEngine.wrappers.prebid','wikia.log'],function(adaptersRegistry,bidHelper,prebid,log){'use strict';var logGroup='ext.wikia.adEngine.lookup.prebid.adaptersPricesTracker';function getSlotBestPrice(slotName){var getBidResponsesFunction=prebid.get().getBidResponsesForAdUnitCode,slotBids=[],bestPrices={};if(getBidResponsesFunction){slotBids=getBidResponsesFunction(slotName).bids||[];adaptersRegistry.getAdapters().forEach(function(adapter){bestPrices[adapter.getName()]='';});log(['getSlotBestPrices slotBids',slotName,slotBids],'debug',logGroup);slotBids.forEach(function(bid){if(isValidPrice(bid)){var bidderCode=bid.bidderCode,cpmPrice=bidHelper.transformPriceFromBid(bid);bestPrices[bidderCode]=Math.max(bestPrices[bidderCode]||0,parseFloat(cpmPrice)).toFixed(2).toString();log(['getSlotBestPrices best price for slot',
slotName,bidderCode,bestPrices[bidderCode]],'debug',logGroup);}});}return bestPrices;}function isValidPrice(bid){return bid.getStatusCode&&bid.getStatusCode()===prebid.validResponseStatusCode;}return{getSlotBestPrice:getSlotBestPrice,_isValidPrice:isValidPrice}});;define('ext.wikia.adEngine.lookup.prebid.adaptersRegistry',['ext.wikia.adEngine.lookup.prebid.adapters.aol','ext.wikia.adEngine.lookup.prebid.adapters.appnexus','ext.wikia.adEngine.lookup.prebid.adapters.appnexusAst','ext.wikia.adEngine.lookup.prebid.adapters.appnexusWebAds','ext.wikia.adEngine.lookup.prebid.adapters.audienceNetwork','ext.wikia.adEngine.lookup.prebid.adapters.beachfront','ext.wikia.adEngine.lookup.prebid.adapters.indexExchange','ext.wikia.adEngine.lookup.prebid.adapters.openx','ext.wikia.adEngine.lookup.prebid.adapters.onemobile','ext.wikia.adEngine.lookup.prebid.adapters.pubmatic','ext.wikia.adEngine.lookup.prebid.adapters.rubicon','ext.wikia.adEngine.lookup.prebid.adapters.rubiconDisplay',
'ext.wikia.adEngine.lookup.prebid.adapters.wikia','wikia.window'],function(aol,appnexus,appnexusAst,appnexusWebAds,audienceNetwork,beachfront,indexExchange,onemobile,openx,pubmatic,rubicon,rubiconDisplay,wikia,win){'use strict';var adapters=[aol,appnexus,appnexusAst,appnexusWebAds,audienceNetwork,beachfront,indexExchange,onemobile,openx,pubmatic,rubicon,rubiconDisplay],customAdapters=[wikia];function getAdapters(){return adapters;}function push(adapter){adapters.push(adapter);}function registerAliases(){adapters.forEach(function(adapter){var aliasMap={};if(typeof adapter.getAliases==='function'){win.pbjs.que.push(function(){aliasMap=adapter.getAliases();Object.keys(aliasMap).forEach(function(bidderName){aliasMap[bidderName].forEach(function(alias){win.pbjs.aliasBidder(bidderName,alias);});});});}});}function setupCustomAdapters(){customAdapters.forEach(function(adapter){push(adapter);win.pbjs.que.push(function(){win.pbjs.registerBidAdapter(adapter.create,adapter.getName());});});}
function getPriorities(){var priority={};adapters.forEach(function(adapter){priority[adapter.getName()]=typeof adapter.getPriority==='function'?adapter.getPriority():1;});return priority;}return{getAdapters:getAdapters,getPriorities:getPriorities,push:push,registerAliases:registerAliases,setupCustomAdapters:setupCustomAdapters};});;define('ext.wikia.adEngine.lookup.prebid.adapters.aol',['ext.wikia.adEngine.context.slotsContext','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.geo','wikia.instantGlobals'],function(slotsContext,instartLogic,geo,instantGlobals){'use strict';var bidderName='aol',network='9435.1',slots={oasis:{TOP_LEADERBOARD:{size:[728,90],placement:'4431497',network:network,alias:'4431497',sizeId:'225'},TOP_RIGHT_BOXAD:{size:[300,250],placement:'4431473',network:network,alias:'4431473',sizeId:'170'}},mercury:{MOBILE_TOP_LEADERBOARD:{size:[320,50],placement:'4436772',network:network,alias:'4436772',sizeId:'3055'},MOBILE_IN_CONTENT:{size:[300,250],placement:
'4431565',network:network,alias:'4431565',sizeId:'170'},MOBILE_PREFOOTER:{size:[300,250],placement:'4431566',network:network,alias:'4431566',sizeId:'170'}}};function isEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverAolBidderCountries)&&!instartLogic.isBlocking();}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function prepareAdUnit(slotName,config){return{code:slotName,sizes:[config.size],bids:[{bidder:bidderName,params:{placement:config.placement,network:config.network,alias:config.alias,sizeId:config.sizeId}}]};}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.appnexus',['ext.wikia.adEngine.context.slotsContext','ext.wikia.adEngine.lookup.prebid.adapters.appnexusPlacements','wikia.geo','wikia.instantGlobals','wikia.log'],function(slotsContext,appnexusPlacements,geo,instantGlobals,log){'use strict';var bidderName=
'appnexus',logGroup='ext.wikia.adEngine.lookup.prebid.adapters.appnexus',slots={oasis:{TOP_LEADERBOARD:{sizes:[[728,90],[970,250]],position:'atf'},TOP_RIGHT_BOXAD:{sizes:[[300,250],[300,600]],position:'atf'},BOTTOM_LEADERBOARD:{sizes:[[728,90],[970,250]],position:'btf'},INCONTENT_BOXAD_1:{sizes:[[160,600],[300,600],[300,250]],position:'hivi'}},mercury:{MOBILE_TOP_LEADERBOARD:{sizes:[[320,50]]},MOBILE_IN_CONTENT:{sizes:[[300,250],[320,480]]},MOBILE_PREFOOTER:{sizes:[[300,250],[320,50]]}}};function isEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverAppNexusBidderCountries);}function prepareAdUnit(slotName,config,skin,isRecovering){var placementId=appnexusPlacements.getPlacement(skin,config.position,isRecovering);if(!placementId){return;}log(['Requesting appnexus ad',slotName,placementId],log.levels.debug,logGroup);return{code:slotName,sizes:config.sizes,bids:[{bidder:bidderName,params:{placementId:placementId}}]};}function getSlots(skin){return slotsContext.filterSlotMap(slots[
skin]);}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.appnexusAst',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.location'],function(adContext,slotsContext,instartLogic,loc){'use strict';var bidderName='appnexusAst',debugPlacementId='5768085',slots={oasis:{INCONTENT_PLAYER:{placementId:'11543172'}},mercury:{MOBILE_IN_CONTENT:{placementId:'11543173'}}};function isEnabled(){return adContext.getContext().bidders.appnexusAst&&!instartLogic.isBlocking();}function prepareAdUnit(slotName,config){var isDebugMode=loc.href.indexOf('appnexusast_debug_mode=1')>=0;return{code:slotName,sizes:[640,480],mediaType:'video-outstream',bids:[{bidder:bidderName,params:{placementId:isDebugMode?debugPlacementId:config.placementId,video:{skippable:!1,playback_method:['auto_play_sound_off']}
}}]};}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.appnexusWebAds',['ext.wikia.adEngine.context.slotsContext','wikia.geo','wikia.instantGlobals','wikia.log'],function(slotsContext,geo,instantGlobals,log){'use strict';var bidderName='appnexusWebAds',aliases={'appnexusAst':[bidderName]},logGroup='ext.wikia.adEngine.lookup.prebid.adapters.appnexusWebAds',priorityLevel=0,slots={oasis:{INCONTENT_BOXAD_1:{placementId:'11283988',sizes:[[300,600],[300,250],[120,600],[160,600]]}}};function isEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverAppNexusWebAdsBidderCountries);}function prepareAdUnit(slotName,config){var placementId=config.placementId;log(['Requesting appnexusWebAds ad',slotName,placementId],log.levels.debug,logGroup);return{code:slotName,sizes:config.sizes,bids:[{bidder
:bidderName,params:{placementId:placementId}}]};}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function getName(){return bidderName;}function getPriority(){return priorityLevel;}function getAliases(){return aliases;}return{isEnabled:isEnabled,getName:getName,getPriority:getPriority,getAliases:getAliases,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.appnexusPlacements',['ext.wikia.adEngine.adContext','wikia.log'],function(adContext,log){'use strict';var logGroup='ext.wikia.adEngine.lookup.prebid.adapters.appnexusPlacements',placementsMap={mercury:{ent:'9412992',gaming:'9412993',life:'9412994',other:'9412994'},oasis:{recovery:{atf:'11823778',btf:'11823724',hivi:'11823799'},pal:{atf:'11977073',btf:'11977096',hivi:'11977016',other:'11969927'}}};function getPlacement(skin,position,isRecovering){var context=adContext.getContext(),vertical=skin==='oasis'?'pal':context.targeting.mappedVerticalName,skinVertical;if(
isRecovering){vertical='recovery';}if(placementsMap&&placementsMap[skin]&&placementsMap[skin][vertical]){skinVertical=placementsMap[skin][vertical];return position&&skinVertical[position]?skinVertical[position]:skinVertical;}log(['getPlacement',skin,vertical,position,'placement not found'],'error',logGroup);}return{getPlacement:getPlacement};});;define('ext.wikia.adEngine.lookup.prebid.adapters.audienceNetwork',['ext.wikia.adEngine.context.slotsContext','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.geo','wikia.instantGlobals','ext.wikia.adEngine.adContext','wikia.querystring'],function(slotsContext,instartLogic,geo,instantGlobals,adContext,querystring){'use strict';var bidderName='audienceNetwork',slots={mercury:{MOBILE_TOP_LEADERBOARD:{sizes:[[320,50]],placementId:'963689110376230_1245837502161388'},MOBILE_IN_CONTENT:{sizes:[[300,250]],placementId:'963689110376230_1245838625494609'},MOBILE_PREFOOTER:{sizes:[[300,250]],placementId:'963689110376230_1245839585494513'}}};
function isEnabled(){var isAudienceNetworkAvailable=adContext.getContext().providers.audienceNetwork;return adContext.getContext().targeting.skin==='mercury'&&isAudienceNetworkAvailable&&geo.isProperGeo(instantGlobals.wgAdDriverAudienceNetworkBidderCountries)&&!instartLogic.isBlocking();}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function prepareAdUnit(slotName,config){return{code:slotName,sizes:config.sizes,bids:[{bidder:bidderName,params:{testMode:querystring().getVal('audiencenetworktest','')==='true',placementId:config.placementId}}]};}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.beachfront',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.location','wikia.log'],function(adContext,slotsContext,instartLogic,loc,log){'use strict';var
bidderName='beachfront',bidfloor=0.01,debugAppId='2e55f7ad-3558-49eb-a3e1-056ccd0e74e2',logGroup='ext.wikia.adEngine.lookup.prebid.adapters.beachfront',slots={oasis:{INCONTENT_PLAYER:{appId:'d239e601-dd57-4163-fe5d-35012d77395f'}},mercury:{MOBILE_IN_CONTENT:{appId:'f377a8b1-c5c0-4108-f932-0102a81ff43d'}}};function isEnabled(){return adContext.getContext().bidders.beachfront&&!instartLogic.isBlocking();}function prepareAdUnit(slotName,config){var isDebugMode=loc.href.indexOf('beachfront_debug_mode=1')>=0;var adUnit={code:slotName,sizes:[640,480],mediaType:'video',bids:[{bidder:bidderName,params:{bidfloor:bidfloor,appId:isDebugMode?debugAppId:config.appId}}]};log(['prepareAdUnit',adUnit],log.levels.debug,logGroup);return adUnit;}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define(
'ext.wikia.adEngine.lookup.prebid.adapters.indexExchange',['ext.wikia.adEngine.context.slotsContext','wikia.geo','wikia.instantGlobals'],function(slotsContext,geo,instantGlobals){'use strict';var bidderName='indexExchange',slots={oasis:{TOP_LEADERBOARD:{sizes:[[728,90],[970,250]],id:'1',siteID:183423},TOP_RIGHT_BOXAD:{sizes:[[300,250],[300,600]],id:'2',siteID:183567},INCONTENT_BOXAD_1:{sizes:[[160,600],[300,600],[300,250]],id:'9',siteID:185049},BOTTOM_LEADERBOARD:{sizes:[[728,90],[970,250]],id:'12',siteID:209250}},mercury:{MOBILE_TOP_LEADERBOARD:{sizes:[[320,50]],id:'3',siteID:183568},MOBILE_IN_CONTENT:{sizes:[[300,250],[320,480]],id:'10',siteID:185055},MOBILE_PREFOOTER:{sizes:[[300,250],[320,50]],id:'11',siteID:185056}},recovery:{TOP_LEADERBOARD:{sizes:[[728,90],[970,250]],id:'1',siteID:215807},TOP_RIGHT_BOXAD:{sizes:[[300,250],[300,600]],id:'2',siteID:215808},INCONTENT_BOXAD_1:{sizes:[[160,600],[300,600],[300,250]],id:'9',siteID:215809},BOTTOM_LEADERBOARD:{sizes:[[728,90],[970,250]],
id:'12',siteID:215810}}};function isEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverIndexExchangeBidderCountries);}function getSlots(skin,isRecovering){var key=isRecovering?'recovery':skin;return slotsContext.filterSlotMap(slots[key]);}function prepareAdUnit(slotName,config){return{code:slotName,sizes:config.sizes,bids:[{bidder:bidderName,params:{id:config.id,siteID:config.siteID}}]};}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.onemobile',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.geo','wikia.instantGlobals'],function(adContext,slotsContext,instartLogic,geo,instantGlobals){'use strict';var bidderName='onemobile',siteId='2c9d2b50015e5e9a6540a64f3eac0266',slots={mercury:{MOBILE_TOP_LEADERBOARD:{size:[320,50],pos:'wikia_mw_top_leaderboard_hb'},
MOBILE_IN_CONTENT:{size:[300,250],pos:'wikia_mw_incontent_hb'},MOBILE_PREFOOTER:{size:[300,250],pos:'wikia_mw_pre_footer_hb'}}};function isEnabled(){return adContext.get('targeting.skin')==='mercury'&&geo.isProperGeo(instantGlobals.wgAdDriverAolOneMobileBidderCountries)&&!instartLogic.isBlocking();}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function prepareAdUnit(slotName,config){return{code:slotName,sizes:[config.size],bids:[{bidder:bidderName,params:{dcn:siteId,pos:config.pos}}]};}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.openx',['ext.wikia.adEngine.context.slotsContext','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.geo','wikia.instantGlobals'],function(slotsContext,instartLogic,geo,instantGlobals){'use strict';var bidderName='openx',delDomain='wikia-d.openx.net',slots={oasis:{TOP_LEADERBOARD:{sizes:[[728,
90],[970,250]],unit:538735690},TOP_RIGHT_BOXAD:{sizes:[[300,250],[300,600]],unit:538735691},INCONTENT_BOXAD_1:{sizes:[[300,250],[300,600],[160,600]],unit:538735697},BOTTOM_LEADERBOARD:{sizes:[[728,90],[970,250]],unit:539119447}},mercury:{MOBILE_IN_CONTENT:{sizes:[[300,250],[320,480]],unit:538735699},MOBILE_PREFOOTER:{sizes:[[300,250],[320,50]],unit:538735700},MOBILE_TOP_LEADERBOARD:{sizes:[[320,50]],unit:538735698}}};function isEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverOpenXPrebidBidderCountries)&&!instartLogic.isBlocking();}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function prepareAdUnit(slotName,config){return{code:slotName,sizes:config.sizes,bids:[{bidder:bidderName,params:{unit:config.unit,delDomain:delDomain}}]};}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.pubmatic',[
'ext.wikia.adEngine.context.slotsContext','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.geo','wikia.instantGlobals','wikia.log'],function(slotsContext,instartLogic,geo,instantGlobals,log){'use strict';var bidderName='pubmatic',logGroup='ext.wikia.adEngine.lookup.prebid.adapters.pubmatic',publisherId=156260,slots={oasis:{TOP_LEADERBOARD:{sizes:[[728,90],[970,250]],ids:['/5441/TOP_LEADERBOARD_728x90@728x90','/5441/TOP_LEADERBOARD_970x250@970x250']},TOP_RIGHT_BOXAD:{sizes:[[300,250],[300,600]],ids:['/5441/TOP_RIGHT_BOXAD_300x250@300x250','/5441/TOP_RIGHT_BOXAD_300x600@300x600']},BOTTOM_LEADERBOARD:{sizes:[[728,90],[970,250]],ids:['/5441/BOTTOM_LEADERBOARD_728x90@728x90','/5441/BOTTOM_LEADERBOARD_970x250@970x250']},INCONTENT_BOXAD_1:{sizes:[[160,600],[300,600],[300,250]],ids:['/5441/INCONTENT_BOXAD_1_160x600@160x600','/5441/INCONTENT_BOXAD_1_300x250@300x250','/5441/INCONTENT_BOXAD_1_300x600@300x600']}},mercury:{MOBILE_TOP_LEADERBOARD:{sizes:[[320,50]],ids:[
'/5441/MOBILE_TOP_LEADERBOARD_320x50@320x50']},MOBILE_IN_CONTENT:{sizes:[[300,250],[320,480]],ids:['/5441/MOBILE_IN_CONTENT_300x250@300x250','/5441/MOBILE_IN_CONTENT_320x480@320x480']},MOBILE_PREFOOTER:{sizes:[[300,250],[320,50]],ids:['/5441/MOBILE_PREFOOTER_300x250@300x250','/5441/MOBILE_PREFOOTER_320x50@320x50']}}};function isEnabled(){return geo.isProperGeo(instantGlobals.wgAdDriverPubMaticBidderCountries)&&!instartLogic.isBlocking();}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function prepareAdUnit(slotName,config){log(['Requesting pubMatic ad',slotName,config.ids],log.levels.debug,logGroup);return{code:slotName,sizes:config.sizes,bids:config.ids.map(function(id){return{bidder:bidderName,params:{adSlot:id,publisherId:publisherId}};})};}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.rubicon',[
'ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.adEngine.lookup.prebid.adaptersHelper','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.log'],function(adContext,slotsContext,adaptersHelper,instartLogic,log){'use strict';var bidderName='rubicon',logGroup='ext.wikia.adEngine.lookup.prebid.adapters.rubicon',outstreamSizeId=203,rubiconAccountId=7450,rubiconSiteId=55412,slots={oasis:{INCONTENT_PLAYER:{zoneId:260296,position:'btf'}},mercury:{MOBILE_IN_CONTENT:{zoneId:563110,position:'btf'}}};function getAdContext(){return adContext.getContext();}function isEnabled(){return getAdContext().bidders.rubicon&&!instartLogic.isBlocking();}function prepareAdUnit(slotName,config,skin){var targeting=adaptersHelper.getTargeting(slotName,skin),adUnit,bidParams;bidParams={accountId:rubiconAccountId,siteId:rubiconSiteId,zoneId:config.zoneId,name:slotName,position:config.position,inventory:targeting,video:{playerHeight:480,playerWidth:640,size_id:outstreamSizeId}
};adUnit={code:slotName,sizes:[[640,480]],mediaType:'video',bids:[{bidder:bidderName,params:bidParams}]};log(['prepareAdUnit',adUnit],log.levels.debug,logGroup);return adUnit;}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function getName(){return bidderName;}return{isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.rubiconDisplay',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.adEngine.lookup.prebid.adaptersHelper','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.log'],function(adContext,slotsContext,adaptersHelper,instartLogic,log){'use strict';var bidderName='rubicon_display',aliases={'rubicon':[bidderName]},logGroup='ext.wikia.adEngine.lookup.prebid.adapters.rubiconDisplay',rubiconAccountId=7450,slots={oasis:{TOP_LEADERBOARD:{sizes:[[728,90],[970,250]],targeting:{loc:['top']},position:'atf',siteId:148804,zoneId:704672},
TOP_RIGHT_BOXAD:{sizes:[[300,250],[300,600]],targeting:{loc:['top']},position:'atf',siteId:148804,zoneId:704672},INCONTENT_BOXAD_1:{sizes:[[160,600],[300,600],[300,250]],targeting:{loc:['hivi']},position:'btf',siteId:148804,zoneId:704676},BOTTOM_LEADERBOARD:{sizes:[[728,90],[970,250]],targeting:{loc:['footer']},position:'btf',siteId:148804,zoneId:704674}},mercury:{MOBILE_TOP_LEADERBOARD:{sizes:[[320,50]],position:'atf',siteId:23565,zoneId:87671},MOBILE_IN_CONTENT:{sizes:[[300,250]],position:'btf',siteId:23565,zoneId:87671},MOBILE_PREFOOTER:{sizes:[[300,250],[320,50]],position:'btf',siteId:23565,zoneId:87671}}};function getAdContext(){return adContext.getContext();}function isEnabled(){return getAdContext().bidders.rubiconDisplay&&!instartLogic.isBlocking();}function prepareAdUnit(slotName,config,skin){var targeting=adaptersHelper.getTargeting(slotName,skin),adUnit,bidParams;Object.keys(config.targeting||{}).forEach(function(key){targeting[key]=config.targeting[key];});bidParams={
accountId:rubiconAccountId,siteId:config.siteId,zoneId:config.zoneId,name:slotName,position:config.position,keywords:['rp.fastlane'],inventory:targeting};adUnit={code:slotName,sizes:config.sizes,bids:[{bidder:bidderName,params:bidParams}]};log(['prepareAdUnit',adUnit],log.levels.debug,logGroup);return adUnit;}function getSlots(skin){return slotsContext.filterSlotMap(slots[skin]);}function getName(){return bidderName;}function getAliases(){return aliases;}return{isEnabled:isEnabled,getAliases:getAliases,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.adEngine.lookup.prebid.adapters.wikia',['ext.wikia.adEngine.wrappers.prebid','ext.wikia.aRecoveryEngine.instartLogic.recovery','wikia.document','wikia.querystring'],function(prebid,instartLogic,doc,QueryString){'use strict';var bidderName='wikia',slots={oasis:{TOP_LEADERBOARD:{sizes:[[728,90]]},TOP_RIGHT_BOXAD:{sizes:[[300,250]]}},mercury:{MOBILE_TOP_LEADERBOARD:{sizes:[[320,50]]}}},qs=new QueryString();
function getPrice(){var price=qs.getVal('wikia_adapter',0);return parseInt(price,10)/100;}function isEnabled(){return qs.getVal('wikia_adapter',false)!==!1&&!instartLogic.isBlocking();}function prepareAdUnit(slotName,config){return{code:slotName,sizes:config.sizes,bids:[{bidder:bidderName}]};}function getSlots(skin){return slots[skin];}function getName(){return bidderName;}function getCreative(price,size){var creative=doc.createElement('div'),details=doc.createElement('small'),title=doc.createElement('p');creative.style.background='#00b7e0';creative.style.color='#fff';creative.style.fontFamily='sans-serif';creative.style.height='100%';creative.style.textAlign='center';creative.style.width='100%';title.innerText='Wikia Creative';title.style.fontWeight='bold';title.style.margin='0';title.style.paddingTop='10px';details.innerText='price: '+price+', size: '+size.join('x');creative.appendChild(title);creative.appendChild(details);return creative.outerHTML;}function addBids(bidderRequest)
{bidderRequest.bids.forEach(function(bid){var bidResponse=prebid.get().createBid(1),price=getPrice();bidResponse.bidderCode=bidderRequest.bidderCode;bidResponse.cpm=price;bidResponse.ad=getCreative(price,bid.sizes[0]);bidResponse.width=bid.sizes[0][0];bidResponse.height=bid.sizes[0][1];prebid.get().addBidResponse(bid.placementCode,bidResponse);});}function create(){return{callBids:function(bidderRequest){prebid.push(function(){addBids(bidderRequest);});}};}return{create:create,isEnabled:isEnabled,getName:getName,getSlots:getSlots,prepareAdUnit:prepareAdUnit};});;define('ext.wikia.aRecoveryEngine.instartLogic.recovery',['ext.wikia.adEngine.adContext','wikia.log','wikia.window'],function(adContext,log,win){'use strict';var logGroup='ext.wikia.aRecoveryEngine.instartLogic.recovery',context=adContext.getContext();function isEnabled(){var enabled=!!context.opts.instartLogicRecovery;log(['isEnabled',enabled,log.levels.debug,logGroup]);return enabled;}function isBlocking(){var isBlocking=!!(
win.I11C&&win.I11C.Morph);log(['isBlocking',isBlocking],log.levels.debug,logGroup);return isEnabled()&&isBlocking;}return{isBlocking:isBlocking,isEnabled:isEnabled,isSlotRecoverable:isEnabled};});;define('ext.wikia.adEngine.wrappers.prebid',['wikia.window'],function(win){'use strict';var validResponseStatusCode=1,errorResponseStatusCode=2;win.pbjs=win.pbjs||{};win.pbjs.que=win.pbjs.que||[];function get(){return win.pbjs;}function getBidByAdId(adId){if(!win.pbjs||!win.pbjs._bidsReceived){return null;}var bids=win.pbjs._bidsReceived.filter(function(bid){return adId===bid.adId;});return bids.length?bids[0]:null;}function getWinningVideoBidBySlotName(slotName,allowedBidders){var bids;if(!win.pbjs||!win.pbjs.getBidResponsesForAdUnitCode){return null;}bids=win.pbjs.getBidResponsesForAdUnitCode(slotName).bids||[];return bids.filter(function(bid){var canUseThisBidder=!allowedBidders||allowedBidders.indexOf(bid.bidderCode)!==-1,hasVast=bid.vastUrl||bid.vastContent;return canUseThisBidder&&
hasVast&&bid.cpm>0;}).reduce(function(previousBid,currentBid){if(previousBid===null||currentBid.cpm>previousBid.cpm){return currentBid;}return previousBid;},null);}function push(callback){win.pbjs.que.push(callback);}return{validResponseStatusCode:validResponseStatusCode,errorResponseStatusCode:errorResponseStatusCode,get:get,getBidByAdId:getBidByAdId,getWinningVideoBidBySlotName:getWinningVideoBidBySlotName,push:push};});;

window.visitorType=(document.cookie.indexOf('__utma')>-1)?'Returning':'New';;